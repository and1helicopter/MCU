; generated by Component: ARM Compiler 5.06 update 5 (build 528) Tool: ArmCC [4d3621]
; commandline ArmCC [--c99 --no_integer_literal_pools --list -c --asm --interleave -o.\exec\usart.o --asm_dir=.\LIST\ --list_dir=.\LIST\ --depend=.\exec\usart.d --cpu=Cortex-M4.fp --apcs=interwork -Otime --diag_suppress=9931 -I.\STARTUP -I.\PERIPH -I..\PRG1 -I.\SOURCE -IF:\Program\Keil_v5\ARM\RV31\INC -IF:\Program\Keil_v5\ARM\CMSIS\Include -IF:\Program\Keil_v5\ARM\INC\ST\STM32F4xx -D__UVISION_VERSION=524 -DEK_PP_0815_12_03 -DSTM32F429_439xx --omf_browse=.\exec\usart.crf PERIPH\usart.c]
                          THUMB

                          AREA ||.text||, CODE, READONLY, ALIGN=1

                  UsartDefaultHandler PROC
;;;68     
;;;69     int UsartDefaultHandler(int RxCount, unsigned char *RxBuffer, unsigned char *TxBuffer, int Status, int PortNum) {return 0;}
000000  2000              MOVS     r0,#0
000002  4770              BX       lr
;;;70     
                          ENDP

                  CalcCRC PROC
;;;80     
;;;81     unsigned short CalcCRC(int Count, unsigned char *Buff) {
000004  b410              PUSH     {r4}
000006  1e03              SUBS     r3,r0,#0
;;;82       unsigned short CRCCode = 0xFFFF;
000008  f64f70ff          MOV      r0,#0xffff
;;;83       int i;
;;;84     	for (i = 0; i < Count; i++) CRCCode = ((CRCCode >> 8) & 0xFF) ^ CRCTable[(CRCCode ^ Buff[i]) & 0xFF];
00000c  f04f0200          MOV      r2,#0
000010  bfc7              ITTEE    GT
000012  f2400c00          MOVWGT   r12,#:LOWER16: ||.data||+32
000016  f2c00c00          MOVTGT   r12,#:UPPER16: ||.data||+32
;;;85     	return CRCCode;
;;;86     }
00001a  bc10              POPLE    {r4}
00001c  4770              BXLE     lr
                  |L1.30|
00001e  5c8c              LDRB     r4,[r1,r2]            ;84
000020  1c52              ADDS     r2,r2,#1              ;84
000022  4044              EORS     r4,r4,r0              ;84
000024  b2e4              UXTB     r4,r4                 ;84
000026  4293              CMP      r3,r2                 ;84
000028  f83c4014          LDRH     r4,[r12,r4,LSL #1]    ;84
00002c  ea842010          EOR      r0,r4,r0,LSR #8       ;84
000030  dcf5              BGT      |L1.30|
000032  bc10              POP      {r4}
000034  4770              BX       lr
;;;87     
                          ENDP

                  ModbusErr PROC
;;;88     int  ModbusErr(int ErrCode, unsigned char *RxBuff, unsigned char *TxBuff) {
000036  b510              PUSH     {r4,lr}
;;;89     unsigned short CRCCode;
;;;90     	((short *)TxBuff)[0] = ((short *)RxBuff)[0] | 0x8000;
000038  8809              LDRH     r1,[r1,#0]
00003a  4614              MOV      r4,r2                 ;88
00003c  f4414100          ORR      r1,r1,#0x8000
000040  8011              STRH     r1,[r2,#0]
;;;91     	TxBuff[2] = ErrCode;
000042  7090              STRB     r0,[r2,#2]
;;;92     	CRCCode   = CalcCRC(3, TxBuff);
000044  4611              MOV      r1,r2
000046  2003              MOVS     r0,#3
000048  f7fffffe          BL       CalcCRC
;;;93     	TxBuff[3] = CRCCode;
00004c  70e0              STRB     r0,[r4,#3]
;;;94     	TxBuff[4] = CRCCode >> 8;
00004e  0a00              LSRS     r0,r0,#8
000050  7120              STRB     r0,[r4,#4]
;;;95     	return 5;
000052  2005              MOVS     r0,#5
;;;96     }	
000054  bd10              POP      {r4,pc}
;;;97     
                          ENDP

                  InitUsart PROC
;;;98     
;;;99     void InitUsart(int Channel, int Params, UsartProc_Type Proc) {
000056  e92d4ff0          PUSH     {r4-r11,lr}
;;;100    
;;;101    	switch (Channel) {
;;;102    	  case 1:		{	/*USART1 with DMA RECIEVE & TRANSMIT Configuration																								*/
;;;103    #if (USART1_PRESENT == YES)			
;;;104    								if (RCC->APB2ENR & RCC_APB2ENR_USART1EN) return;						/* Already init												*/
;;;105    								RCC->APB2ENR |= RCC_APB2ENR_USART1EN;												/* USART1 Clock Enable								*/
;;;106    			
;;;107    								USART1_Proc 	= Proc;
;;;108    	
;;;109    								RCC->AHB1ENR |= RCC_AHB1ENR_DMA2EN;													/* DMA2 Clock enable									*/
00005a  f6430b30          MOV      r11,#0x3830
;;;110    
;;;111    								/* Recieve DMA Configuration	-------------------------------------------------------------------	*/
;;;112    								DMA2->HIFCR				 	= (0x3Dul << 6);												/* Clear DMA interrupr status bits		*/
;;;113    								DMA2_Stream5->PAR 	= (unsigned int)&(USART1->DR);
;;;114    								DMA2_Stream5->M0AR 	= (unsigned int)USART1_RX_Buff;
;;;115    								DMA2_Stream5->NDTR 	= USART_Buff_length;
;;;116    								DMA2_Stream5->CR	 	= (4ul << 25) 	|												/* Channel #4													*/
00005e  f2404601          MOV      r6,#0x401
000062  f2c40b02          MOVT     r11,#0x4002           ;109
000066  f6c00600          MOVT     r6,#0x800
;;;117    																			(0ul<< 6)			|												/* Data transfer direction P-to-M			*/
;;;118    																			DMA_SxCR_MINC	|												/* Memory increment mode							*/
;;;119    																			DMA_SxCR_EN;													/* Channel enable											*/
;;;120    
;;;121    								/* Transmit DMA Configuration	------------------------------------------------------------------- */	
;;;122    								DMA2->HIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits		*/
;;;123    								DMA2_Stream7->PAR 	= (unsigned int)&(USART1->DR);
;;;124    							//DMA2_Stream7->M0AR 	= (unsigned int)USART1_TX_Buff;
;;;125    							//DMA2_Stream7->NDTR 	= USART1_TX_Count;
;;;126    								DMA2_Stream7->CR	 	= (4ul << 25) 		|											/* Channel #4													*/
;;;127    																			(1ul<< 6)				|											/* Data transfer direction M-to-P			*/
;;;128    																			DMA_SxCR_MINC;												/* Memory increment mode							*/
;;;129    
;;;130    								USART1->BRR	  			=	APB2CLK / SpeedSelect[(Params & 0x700) >> 8];	/* Set Baudrate										*/
00006a  f2400400          MOVW     r4,#:LOWER16: SystemCoreClock
00006e  f2c00400          MOVT     r4,#:UPPER16: SystemCoreClock
;;;131    								USART1->CR3					= USART_CR3_DMAT	|											/* USART1 DMA Transmit										*/
;;;132    																			USART_CR3_DMAR;												/* USART1 DMA Recieve											*/
;;;133    	
;;;134    								USART1->CR2					= (Params & 0x01) << 13;								/* 2 Stop bits if Bit 0 in Params set			*/
000072  07cb              LSLS     r3,r1,#31
000074  f3c12c02          UBFX     r12,r1,#8,#3          ;130
000078  0c9b              LSRS     r3,r3,#18
;;;135    	
;;;136    								USART1->CR1					=	USART_CR1_RE			|										/* Reciever enable												*/
00007a  f0010106          AND      r1,r1,#6
00007e  f2400700          MOVW     r7,#:LOWER16: ||.data||+24
000082  f2c00700          MOVT     r7,#:UPPER16: ||.data||+24
;;;137    																			USART_CR1_TE			|										/* Transmitter enable											*/
;;;138    																			USART_CR1_IDLEIE	|										/* IDLE Interrupt Enable									*/
;;;139    																			USART_CR1_TCIE		|										/* Transmission complete interrupt enable	*/
;;;140    																			ParitySelect[(Params & 0x06) >> 1] |	/* Parity select													*/
;;;141    																			USART_CR1_UE;													/* USART Enable														*/
;;;142    
;;;143    								NVIC_SetPriority(USART1_IRQn, USART1_Prty);
;;;144    								NVIC_EnableIRQ(USART1_IRQn);																/* USART1	Interrupr enable								*/
;;;145    #endif
;;;146    							} break;
;;;147    	  case 2:		{	/*USART2 with DMA RECIEVE & TRANSMIT Configuration																								*/
;;;148    #if (USART2_PRESENT == YES)			
;;;149    								if (RCC->APB1ENR & RCC_APB1ENR_USART2EN) return;						/* Already init												*/
;;;150    								RCC->APB1ENR |= RCC_APB1ENR_USART2EN;												/* USART2 Clock Enable								*/
;;;151    			
;;;152    								USART2_Proc 	= Proc;
;;;153    	
;;;154    								RCC->AHB1ENR |= RCC_AHB1ENR_DMA1EN;													/* DMA1 Clock enable									*/
;;;155    
;;;156    								/* Recieve DMA Configuration	-------------------------------------------------------------------	*/
;;;157    								DMA1->HIFCR				 	= (0x3Dul << 6);												/* Clear DMA interrupr status bits		*/
;;;158    								DMA1_Stream5->PAR 	= (unsigned int)&(USART2->DR);
;;;159    								DMA1_Stream5->M0AR 	= (unsigned int)USART2_RX_Buff;
;;;160    								DMA1_Stream5->NDTR 	= USART_Buff_length;
;;;161    								DMA1_Stream5->CR	 	= (4ul << 25) 	|												/* Channel #4													*/
;;;162    																			(0ul<< 6)			|												/* Data transfer direction P-to-M			*/
;;;163    																			DMA_SxCR_MINC	|												/* Memory increment mode							*/
;;;164    																			DMA_SxCR_EN;													/* Channel enable											*/
;;;165    
;;;166    								/* Transmit DMA Configuration	------------------------------------------------------------------- */	
;;;167    								DMA1->HIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits		*/
;;;168    								DMA1_Stream6->PAR 	= (unsigned int)&(USART2->DR);
;;;169    							//DMA1_Stream6->M0AR 	= (unsigned int)USART2_TX_Buff;
;;;170    							//DMA1_Stream6->NDTR 	= USART2_TX_Count;
;;;171    								DMA1_Stream6->CR	 	= (4ul << 25) 		|											/* Channel #4													*/
;;;172    																			(1ul<< 6)				|											/* Data transfer direction M-to-P			*/
;;;173    																			DMA_SxCR_MINC;												/* Memory increment mode							*/
;;;174    
;;;175    								USART2->BRR	  			=	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];	/* Set Baudrate										*/
000086  f8d4a000          LDR      r10,[r4,#0]
00008a  25f0              MOVS     r5,#0xf0
00008c  f24e0904          MOV      r9,#0xe004
000090  f242085c          MOV      r8,#0x205c            ;136
000094  f2ce0900          MOVT     r9,#0xe000            ;136
000098  ea4f049a          LSR      r4,r10,#2
00009c  2806              CMP      r0,#6                 ;101
;;;176    								USART2->CR3					= USART_CR3_DMAT	|											/* USART2 DMA Transmit										*/
;;;177    																			USART_CR3_DMAR;												/* USART2 DMA Recieve											*/
;;;178    	
;;;179    								USART2->CR2					= (Params & 0x01) << 13;								/* 2 Stop bits if Bit 0 in Params set			*/
;;;180    	
;;;181    								USART2->CR1					=	USART_CR1_RE			|										/* Reciever enable												*/
;;;182    																			USART_CR1_TE			|										/* Transmitter enable											*/
;;;183    																			USART_CR1_IDLEIE	|										/* IDLE Interrupt Enable									*/
;;;184    																			USART_CR1_TCIE		|										/* Transmission complete interrupt enable	*/
;;;185    																			ParitySelect[(Params & 0x06) >> 1] |	/* Parity select													*/
;;;186    																			USART_CR1_UE;													/* USART Enable														*/
;;;187    
;;;188    								NVIC_SetPriority(USART2_IRQn, USART2_Prty);
;;;189    								NVIC_EnableIRQ(USART2_IRQn);																/* USART2	Interrupr enable								*/
;;;190    #endif
;;;191    							} break;
;;;192    	  case 3:		{	/*USART3 with DMA RECIEVE & TRANSMIT Configuration																								*/
;;;193    #if (USART3_PRESENT == YES)			
;;;194    								if (RCC->APB1ENR & RCC_APB1ENR_USART3EN) return;						/* Already init												*/
;;;195    								RCC->APB1ENR |= RCC_APB1ENR_USART3EN;												/* USART3 Clock Enable								*/
;;;196    			
;;;197    								USART3_Proc 	= Proc;
;;;198    	
;;;199    								RCC->AHB1ENR |= RCC_AHB1ENR_DMA1EN;													/* DMA1 Clock enable									*/
;;;200    
;;;201    								/* Recieve DMA Configuration	-------------------------------------------------------------------	*/
;;;202    								DMA1->LIFCR				 	= (0x3Dul << 6);												/* Clear DMA interrupr status bits		*/
;;;203    								DMA1_Stream1->PAR 	= (unsigned int)&(USART3->DR);
;;;204    								DMA1_Stream1->M0AR 	= (unsigned int)USART3_RX_Buff;
;;;205    								DMA1_Stream1->NDTR 	= USART_Buff_length;
;;;206    								DMA1_Stream1->CR	 	= (4ul << 25) 	|												/* Channel #4													*/
;;;207    																			(0ul<< 6)			|												/* Data transfer direction P-to-M			*/
;;;208    																			DMA_SxCR_MINC	|												/* Memory increment mode							*/
;;;209    																			DMA_SxCR_EN;													/* Channel enable											*/
;;;210    
;;;211    								/* Transmit DMA Configuration	------------------------------------------------------------------- */	
;;;212    								DMA1->LIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits		*/
;;;213    								DMA1_Stream3->PAR 	= (unsigned int)&(USART3->DR);
;;;214    							//DMA1_Stream3->M0AR 	= (unsigned int)USART3_TX_Buff;
;;;215    							//DMA1_Stream3->NDTR 	= USART3_TX_Count;
;;;216    								DMA1_Stream3->CR	 	= (4ul << 25) 		|											/* Channel #4													*/
;;;217    																			(1ul<< 6)				|											/* Data transfer direction M-to-P			*/
;;;218    																			DMA_SxCR_MINC;												/* Memory increment mode							*/
;;;219    
;;;220    								USART3->BRR	  			=	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];	/* Set Baudrate										*/
;;;221    								USART3->CR3					= USART_CR3_DMAT	|											/* USART3 DMA Transmit										*/
;;;222    																			USART_CR3_DMAR;												/* USART3 DMA Recieve											*/
;;;223    	
;;;224    								USART3->CR2					= (Params & 0x01) << 13;								/* 2 Stop bits if Bit 0 in Params set			*/
;;;225    	
;;;226    								USART3->CR1					=	USART_CR1_RE			|										/* Reciever enable												*/
;;;227    																			USART_CR1_TE			|										/* Transmitter enable											*/
;;;228    																			USART_CR1_IDLEIE	|										/* IDLE Interrupt Enable									*/
;;;229    																			USART_CR1_TCIE		|										/* Transmission complete interrupt enable	*/
;;;230    																			ParitySelect[(Params & 0x06) >> 1] |	/* Parity select													*/
;;;231    																			USART_CR1_UE;													/* USART Enable														*/
;;;232    
;;;233    								NVIC_SetPriority(USART3_IRQn, USART3_Prty);
;;;234    								NVIC_EnableIRQ(USART3_IRQn);																/* USART3	Interrupr enable								*/
;;;235    #endif
;;;236    							} break;
;;;237    		case 4:		{	/*USART4 with DMA RECIEVE & TRANSMIT Configuration																								*/
;;;238    #if (UART4_PRESENT == YES)		
;;;239    								if (RCC->APB1ENR & RCC_APB1ENR_UART4EN) return;							/* Already init												*/
;;;240    								RCC->APB1ENR |= RCC_APB1ENR_UART4EN;												/* UART4 Clock Enable									*/
;;;241    
;;;242    								USART4_Proc 	= Proc;
;;;243    	
;;;244    								RCC->AHB1ENR |= RCC_AHB1ENR_DMA1EN;													/* DMA1 Clock enable									*/
;;;245    
;;;246    								/* Recieve DMA Configuration	-------------------------------------------------------------------	*/
;;;247    								DMA1->LIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits		*/
;;;248    								DMA1_Stream2->PAR 	= (unsigned int)&(UART4->DR);
;;;249    								DMA1_Stream2->M0AR 	= (unsigned int)USART4_RX_Buff;
;;;250    								DMA1_Stream2->NDTR 	= USART_Buff_length;
;;;251    								DMA1_Stream2->CR	 	= (4ul << 25) 	|												/* Channel #4													*/
;;;252    																			(0ul<< 6)			|												/* Data transfer direction P-to-M			*/
;;;253    																			DMA_SxCR_MINC	|												/* Memory increment mode							*/
;;;254    																			DMA_SxCR_EN;													/* Channel enable											*/
;;;255    
;;;256    								/* Transmit DMA Configuration	------------------------------------------------------------------- */	
;;;257    								DMA1->HIFCR				 	= (0x3Dul << 0);												/* Clear DMA interrupr status bits		*/
;;;258    								DMA1_Stream4->PAR 	= (unsigned int)&(UART4->DR);
;;;259    							//DMA1_Stream4->M0AR 	= (unsigned int)USART4_TX_Buff;
;;;260    							//DMA1_Stream4->NDTR 	= USART4_TX_Count;
;;;261    								DMA1_Stream4->CR	 	= (4ul << 25) 		|											/* Channel #4													*/
;;;262    																			(1ul<< 6)				|											/* Data transfer direction M-to-P			*/
;;;263    																			DMA_SxCR_MINC;												/* Memory increment mode							*/
;;;264    
;;;265    								UART4->BRR	  			=	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];	/* Set Baudrate										*/
;;;266    								UART4->CR3					= USART_CR3_DMAT	|											/* UART4 DMA Transmit											*/
;;;267    																			USART_CR3_DMAR;												/* UART4 DMA Recieve											*/
;;;268    	
;;;269    								UART4->CR2					= (Params & 0x01) << 13;								/* 2 Stop bits if Bit 0 in Params set			*/
;;;270    	
;;;271    								UART4->CR1					=	USART_CR1_RE			|										/* Reciever enable												*/
;;;272    																			USART_CR1_TE			|										/* Transmitter enable											*/
;;;273    																			USART_CR1_IDLEIE	|										/* IDLE Interrupt Enable									*/
;;;274    																			USART_CR1_TCIE		|										/* Transmission complete interrupt enable	*/
;;;275    																			ParitySelect[(Params & 0x06) >> 1] |	/* Parity select													*/
;;;276    																			USART_CR1_UE;													/* USART Enable														*/
;;;277    
;;;278    								NVIC_SetPriority(UART4_IRQn, UART4_Prty);
;;;279    								NVIC_EnableIRQ(UART4_IRQn);																	/* UART4	Interrupr enable								*/
;;;280    #endif								
;;;281    							} break;
;;;282    		case 5:		{	/*USART5 with DMA RECIEVE & TRANSMIT Configuration																								*/
;;;283    #if (UART5_PRESENT == YES)
;;;284    								if (RCC->APB1ENR & RCC_APB1ENR_UART5EN) return;							/* Already init												*/
;;;285    								RCC->APB1ENR |= RCC_APB1ENR_UART5EN;												/* UART5 Clock Enable									*/
;;;286    
;;;287    								USART5_Proc 	= Proc;
;;;288    	
;;;289    								RCC->AHB1ENR |= RCC_AHB1ENR_DMA1EN;													/* DMA1 Clock enable									*/
;;;290    
;;;291    								/* Recieve DMA Configuration	-------------------------------------------------------------------	*/
;;;292    								DMA1->LIFCR				 	= (0x3Dul << 0);												/* Clear DMA interrupr status bits		*/
;;;293    								DMA1_Stream0->PAR 	= (unsigned int)&(UART5->DR);
;;;294    								DMA1_Stream0->M0AR 	= (unsigned int)USART5_RX_Buff;
;;;295    								DMA1_Stream0->NDTR 	= USART_Buff_length;
;;;296    								DMA1_Stream0->CR	 	= (4ul << 25) 	|												/* Channel #4													*/
;;;297    																			(0ul<< 6)			|												/* Data transfer direction P-to-M			*/
;;;298    																			DMA_SxCR_MINC	|												/* Memory increment mode							*/
;;;299    																			DMA_SxCR_EN;													/* Channel enable											*/
;;;300    
;;;301    								/* Transmit DMA Configuration	------------------------------------------------------------------- */	
;;;302    								DMA1->HIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits		*/
;;;303    								DMA1_Stream7->PAR 	= (unsigned int)&(UART5->DR);
;;;304    							//DMA1_Stream7->M0AR 	= (unsigned int)USART5_TX_Buff;
;;;305    							//DMA1_Stream7->NDTR 	= USART5_TX_Count;
;;;306    								DMA1_Stream7->CR	 	= (4ul << 25) 		|											/* Channel #4													*/
;;;307    																			(1ul<< 6)				|											/* Data transfer direction M-to-P			*/
;;;308    																			DMA_SxCR_MINC;												/* Memory increment mode							*/
;;;309    
;;;310    								UART5->BRR	  			=	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];	/* Set Baudrate										*/
;;;311    								UART5->CR3					= USART_CR3_DMAT	|											/* UART5 DMA Transmit											*/
;;;312    																			USART_CR3_DMAR;												/* UART5 DMA Recieve											*/
;;;313    	
;;;314    								UART5->CR2					= (Params & 0x01) << 13;								/* 2 Stop bits if Bit 0 in Params set			*/
;;;315    	
;;;316    								UART5->CR1					=	USART_CR1_RE			|										/* Reciever enable												*/
;;;317    																			USART_CR1_TE			|										/* Transmitter enable											*/
;;;318    																			USART_CR1_IDLEIE	|										/* IDLE Interrupt Enable									*/
;;;319    																			USART_CR1_TCIE		|										/* Transmission complete interrupt enable	*/
;;;320    																			ParitySelect[(Params & 0x06) >> 1] |	/* Parity select													*/
;;;321    																			USART_CR1_UE;													/* UART Enable														*/
;;;322    
;;;323    								NVIC_SetPriority(UART5_IRQn, UART5_Prty);
;;;324    								NVIC_EnableIRQ(UART5_IRQn);																	/* UART5	Interrupr enable								*/
;;;325    #endif								
;;;326    							} break;		
;;;327    		case 6:		{	/*USART6 with DMA RECIEVE & TRANSMIT Configuration																								*/
;;;328    #if (USART6_PRESENT == YES)	
;;;329    								if (RCC->APB2ENR & RCC_APB2ENR_USART6EN) return;						/* Already init												*/
;;;330    								RCC->APB2ENR |= RCC_APB2ENR_USART6EN;												/* USART6 Clock Enable								*/
;;;331    
;;;332    								USART6_Proc 	= Proc;
;;;333    	
;;;334    								RCC->AHB1ENR |= RCC_AHB1ENR_DMA2EN;													/* DMA2 Clock enable									*/
;;;335    
;;;336    								/* Recieve DMA Configuration	-------------------------------------------------------------------	*/
;;;337    								DMA2->LIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits		*/
;;;338    								DMA2_Stream2->PAR 	= (unsigned int)&(USART6->DR);
;;;339    								DMA2_Stream2->M0AR 	= (unsigned int)USART6_RX_Buff;
;;;340    								DMA2_Stream2->NDTR 	= USART_Buff_length;
;;;341    								DMA2_Stream2->CR	 	= (5ul << 25) 	|												/* Channel #5													*/
;;;342    																			(0ul<< 6)			|												/* Data transfer direction P-to-M			*/
;;;343    																			DMA_SxCR_MINC	|												/* Memory increment mode							*/
;;;344    																			DMA_SxCR_EN;													/* Channel enable											*/
;;;345    
;;;346    								/* Transmit DMA Configuration	------------------------------------------------------------------- */	
;;;347    								DMA2->HIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits		*/
;;;348    								DMA2_Stream6->PAR 	= (unsigned int)&(USART6->DR);
;;;349    							//DMA2_Stream6->M0AR 	= (unsigned int)USART6_TX_Buff;
;;;350    							//DMA2_Stream6->NDTR 	= USART5_TX_Count;
;;;351    								DMA2_Stream6->CR	 	= (5ul << 25) 		|											/* Channel #5													*/
;;;352    																			(1ul<< 6)				|											/* Data transfer direction M-to-P			*/
;;;353    																			DMA_SxCR_MINC;												/* Memory increment mode							*/
;;;354    
;;;355    								USART6->BRR	  			=	APB2CLK / SpeedSelect[(Params & 0x700) >> 8];	/* Set Baudrate										*/
;;;356    								USART6->CR3					= USART_CR3_DMAT	|											/* USART6 DMA Transmit										*/
;;;357    																			USART_CR3_DMAR;												/* USART6 DMA Recieve											*/
;;;358    	
;;;359    								USART6->CR2					= (Params & 0x01) << 13;								/* 2 Stop bits if Bit 0 in Params set			*/
;;;360    	
;;;361    								USART6->CR1					=	USART_CR1_RE			|										/* Reciever enable												*/
;;;362    																			USART_CR1_TE			|										/* Transmitter enable											*/
;;;363    																			USART_CR1_IDLEIE	|										/* IDLE Interrupt Enable									*/
;;;364    																			USART_CR1_TCIE		|										/* Transmission complete interrupt enable	*/
;;;365    																			ParitySelect[(Params & 0x06) >> 1] |	/* Parity select													*/
;;;366    																			USART_CR1_UE;													/* USART Enable														*/
;;;367    
;;;368    								NVIC_SetPriority(USART6_IRQn, USART6_Prty);
;;;369    								NVIC_EnableIRQ(USART6_IRQn);																/* USART6	Interrupr enable								*/
;;;370    #endif								
;;;371    							} break;
;;;372    							
;;;373    							
;;;374    	} //switch (Channel)
;;;375    } //void InitUsart(int Channel, int Speed, int Parity, int StopBit, int Master, UsartProc_Type Proc)
00009e  bf28              IT       CS
0000a0  e8bd8ff0          POPCS    {r4-r11,pc}
0000a4  e8dff000          TBB      [pc,r0]
0000a8  fd0370d5          DCB      0xfd,0x03,0x70,0xd5
0000ac  fcfb              DCB      0xfc,0xfb
0000ae  f6430044          MOV      r0,#0x3844            ;104
0000b2  f2c40002          MOVT     r0,#0x4002            ;104
0000b6  6804              LDR      r4,[r0,#0]            ;104
0000b8  f0140f10          TST      r4,#0x10              ;104
0000bc  bf18              IT       NE
0000be  e8bd8ff0          POPNE    {r4-r11,pc}
0000c2  6804              LDR      r4,[r0,#0]            ;105
0000c4  f0440410          ORR      r4,r4,#0x10           ;105
0000c8  6004              STR      r4,[r0,#0]            ;105
0000ca  f2400000          MOVW     r0,#:LOWER16: ||.data||;107
0000ce  f2c00000          MOVT     r0,#:UPPER16: ||.data||;107
0000d2  6002              STR      r2,[r0,#0]            ;109  ; USART1_Proc
0000d4  f8db0000          LDR      r0,[r11,#0]           ;109
0000d8  f4400080          ORR      r0,r0,#0x400000       ;109
0000dc  f8cb0000          STR      r0,[r11,#0]           ;109
0000e0  f246440c          MOV      r4,#0x640c            ;112
0000e4  f2c40402          MOVT     r4,#0x4002            ;112
0000e8  f44f6074          MOV      r0,#0xf40             ;112
0000ec  6020              STR      r0,[r4,#0]            ;112
0000ee  f2464290          MOV      r2,#0x6490            ;113
0000f2  f2410004          MOV      r0,#0x1004            ;113
0000f6  f2c40202          MOVT     r2,#0x4002            ;113
0000fa  f2c40001          MOVT     r0,#0x4001            ;113
0000fe  6010              STR      r0,[r2,#0]            ;113
000100  f2400200          MOVW     r2,#:LOWER16: ||.bss||+128;114
000104  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+128;114
000108  f2464b94          MOV      r11,#0x6494           ;114
00010c  f2c40b02          MOVT     r11,#0x4002           ;114
000110  f8cb2000          STR      r2,[r11,#0]           ;114
000114  f2464b8c          MOV      r11,#0x648c           ;115
000118  f2c40b02          MOVT     r11,#0x4002           ;115
00011c  2280              MOVS     r2,#0x80              ;115
00011e  f8cb2000          STR      r2,[r11,#0]           ;115
000122  f1ab0204          SUB      r2,r11,#4             ;116
000126  6016              STR      r6,[r2,#0]            ;116
000128  f04f6274          MOV      r2,#0xf400000         ;122
00012c  6022              STR      r2,[r4,#0]            ;122
00012e  f24642c0          MOV      r2,#0x64c0            ;123
000132  f2c40202          MOVT     r2,#0x4002            ;123
000136  6010              STR      r0,[r2,#0]            ;123
000138  f24642b8          MOV      r2,#0x64b8            ;126
00013c  f44f6088          MOV      r0,#0x440             ;126
000140  f2c40202          MOVT     r2,#0x4002            ;126
000144  f6c00000          MOVT     r0,#0x800             ;126
000148  6010              STR      r0,[r2,#0]            ;126
00014a  ea4f025a          LSR      r2,r10,#1             ;130
00014e  f2400000          MOVW     r0,#:LOWER16: ||.data||+544;130
000152  f2c00000          MOVT     r0,#:UPPER16: ||.data||+544;130
000156  f850002c          LDR      r0,[r0,r12,LSL #2]    ;130
00015a  fbb2f2f0          UDIV     r2,r2,r0              ;130
00015e  f44f5080          MOV      r0,#0x1000            ;130
000162  f2c40001          MOVT     r0,#0x4001            ;130
000166  8102              STRH     r2,[r0,#8]            ;130
000168  22c0              MOVS     r2,#0xc0              ;131
00016a  8282              STRH     r2,[r0,#0x14]         ;131
00016c  8203              STRH     r3,[r0,#0x10]         ;134
00016e  5a79              LDRH     r1,[r7,r1]            ;136
000170  ea410108          ORR      r1,r1,r8              ;136
000174  8181              STRH     r1,[r0,#0xc]          ;136
000176  f24e0025          MOV      r0,#0xe025            ;136
00017a  f2ce0000          MOVT     r0,#0xe000            ;136
00017e  f8805400          STRB     r5,[r0,#0x400]        ;136
000182  2020              MOVS     r0,#0x20              ;136
000184  f000b986          B.W      |L1.1172|
000188  f44f5061          MOV      r0,#0x3840            ;149
00018c  f2c40002          MOVT     r0,#0x4002            ;149
000190  f8d0a000          LDR      r10,[r0,#0]           ;149
000194  f41a3f00          TST      r10,#0x20000          ;149
000198  bf18              IT       NE
00019a  e8bd8ff0          POPNE    {r4-r11,pc}
00019e  f8d0a000          LDR      r10,[r0,#0]           ;150
0001a2  f44a3a00          ORR      r10,r10,#0x20000      ;150
0001a6  f8c0a000          STR      r10,[r0,#0]           ;150
0001aa  f2400000          MOVW     r0,#:LOWER16: ||.data||;152
0001ae  f2c00000          MOVT     r0,#:UPPER16: ||.data||;152
0001b2  6042              STR      r2,[r0,#4]            ;154  ; USART2_Proc
0001b4  f8db0000          LDR      r0,[r11,#0]           ;154
0001b8  f4401000          ORR      r0,r0,#0x200000       ;154
0001bc  f8cb0000          STR      r0,[r11,#0]           ;154
0001c0  f44f40c0          MOV      r0,#0x6000            ;157
0001c4  f2c40002          MOVT     r0,#0x4002            ;157
0001c8  f44f6274          MOV      r2,#0xf40             ;157
0001cc  60c2              STR      r2,[r0,#0xc]          ;157
0001ce  f2444204          MOV      r2,#0x4404            ;158
0001d2  f2c40200          MOVT     r2,#0x4000            ;158
0001d6  f8c02090          STR      r2,[r0,#0x90]         ;158
0001da  f2400a00          MOVW     r10,#:LOWER16: ||.bss||+384;159
0001de  f2c00a00          MOVT     r10,#:UPPER16: ||.bss||+384;159
0001e2  f8c0a094          STR      r10,[r0,#0x94]        ;159
0001e6  f04f0a80          MOV      r10,#0x80             ;160
0001ea  f8c0a08c          STR      r10,[r0,#0x8c]        ;160
0001ee  f8c06088          STR      r6,[r0,#0x88]         ;161
0001f2  f44f1674          MOV      r6,#0x3d0000          ;167
0001f6  60c6              STR      r6,[r0,#0xc]          ;167
0001f8  f8c020a8          STR      r2,[r0,#0xa8]         ;168
0001fc  f44f6288          MOV      r2,#0x440             ;171
000200  f6c00200          MOVT     r2,#0x800             ;171
000204  f8c020a0          STR      r2,[r0,#0xa0]         ;171
000208  f2400000          MOVW     r0,#:LOWER16: ||.data||+544;175
00020c  f2c00000          MOVT     r0,#:UPPER16: ||.data||+544;175
000210  f850002c          LDR      r0,[r0,r12,LSL #2]    ;175
000214  f2444208          MOV      r2,#0x4408            ;175
000218  fbb4f0f0          UDIV     r0,r4,r0              ;175
00021c  f2c40200          MOVT     r2,#0x4000            ;175
000220  8010              STRH     r0,[r2,#0]            ;175
000222  f2444214          MOV      r2,#0x4414            ;176
000226  f2c40200          MOVT     r2,#0x4000            ;176
00022a  20c0              MOVS     r0,#0xc0              ;176
00022c  8010              STRH     r0,[r2,#0]            ;176
00022e  1f10              SUBS     r0,r2,#4              ;179
000230  8003              STRH     r3,[r0,#0]            ;179
000232  5a78              LDRH     r0,[r7,r1]            ;181
000234  f244410c          MOV      r1,#0x440c            ;181
000238  f2c40100          MOVT     r1,#0x4000            ;181
00023c  ea400008          ORR      r0,r0,r8              ;181
000240  8008              STRH     r0,[r1,#0]            ;181
000242  f24e0026          MOV      r0,#0xe026            ;181
000246  f2ce0000          MOVT     r0,#0xe000            ;181
00024a  f8805400          STRB     r5,[r0,#0x400]        ;181
00024e  2040              MOVS     r0,#0x40              ;181
000250  e120              B        |L1.1172|
000252  f44f5061          MOV      r0,#0x3840            ;194
000256  f2c40002          MOVT     r0,#0x4002            ;194
00025a  f8d0a000          LDR      r10,[r0,#0]           ;194
00025e  f41a2f80          TST      r10,#0x40000          ;194
000262  bf18              IT       NE
000264  e8bd8ff0          POPNE    {r4-r11,pc}
000268  f8d0a000          LDR      r10,[r0,#0]           ;195
00026c  f44a2a80          ORR      r10,r10,#0x40000      ;195
000270  f8c0a000          STR      r10,[r0,#0]           ;195
000274  f2400000          MOVW     r0,#:LOWER16: ||.data||;197
000278  f2c00000          MOVT     r0,#:UPPER16: ||.data||;197
00027c  6082              STR      r2,[r0,#8]            ;199  ; USART3_Proc
00027e  f8db0000          LDR      r0,[r11,#0]           ;199
000282  f4401000          ORR      r0,r0,#0x200000       ;199
000286  f8cb0000          STR      r0,[r11,#0]           ;199
00028a  f44f40c0          MOV      r0,#0x6000            ;202
00028e  f2c40002          MOVT     r0,#0x4002            ;202
000292  f44f6274          MOV      r2,#0xf40             ;202
000296  6082              STR      r2,[r0,#8]            ;202
000298  f6440a04          MOV      r10,#0x4804           ;203
00029c  e002              B        |L1.676|
00029e  e0a0              B        |L1.994|
0002a0  e03e              B        |L1.800|
0002a2  e03b              B        |L1.796|
                  |L1.676|
0002a4  f2c40a00          MOVT     r10,#0x4000           ;203
0002a8  f8c0a030          STR      r10,[r0,#0x30]        ;203
0002ac  f2400200          MOVW     r2,#:LOWER16: ||.bss||+640;204
0002b0  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+640;204
0002b4  6342              STR      r2,[r0,#0x34]         ;204
0002b6  2280              MOVS     r2,#0x80              ;205
0002b8  62c2              STR      r2,[r0,#0x2c]         ;205
0002ba  6286              STR      r6,[r0,#0x28]         ;206
0002bc  f04f6674          MOV      r6,#0xf400000         ;212
0002c0  6086              STR      r6,[r0,#8]            ;212
0002c2  f8c0a060          STR      r10,[r0,#0x60]        ;213
0002c6  f44f6688          MOV      r6,#0x440             ;216
0002ca  f6c00600          MOVT     r6,#0x800             ;216
0002ce  6586              STR      r6,[r0,#0x58]         ;216
0002d0  f2400000          MOVW     r0,#:LOWER16: ||.data||+544;220
0002d4  f2c00000          MOVT     r0,#:UPPER16: ||.data||+544;220
0002d8  f850002c          LDR      r0,[r0,r12,LSL #2]    ;220
0002dc  f10a0c04          ADD      r12,r10,#4            ;220
0002e0  fbb4f0f0          UDIV     r0,r4,r0              ;220
0002e4  f8ac0000          STRH     r0,[r12,#0]           ;220
0002e8  f6440c14          MOV      r12,#0x4814           ;221
0002ec  f2c40c00          MOVT     r12,#0x4000           ;221
0002f0  20c0              MOVS     r0,#0xc0              ;221
0002f2  f8ac0000          STRH     r0,[r12,#0]           ;221
0002f6  f1ac0004          SUB      r0,r12,#4             ;224
0002fa  8003              STRH     r3,[r0,#0]            ;224
0002fc  5a78              LDRH     r0,[r7,r1]            ;226
0002fe  f644010c          MOV      r1,#0x480c            ;226
000302  f2c40100          MOVT     r1,#0x4000            ;226
000306  ea400008          ORR      r0,r0,r8              ;226
00030a  8008              STRH     r0,[r1,#0]            ;226
00030c  f24e0027          MOV      r0,#0xe027            ;226
000310  f2ce0000          MOVT     r0,#0xe000            ;226
000314  f8805400          STRB     r5,[r0,#0x400]        ;226
000318  f8c92100          STR      r2,[r9,#0x100]        ;226
                  |L1.796|
00031c  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.800|
000320  f44f5061          MOV      r0,#0x3840            ;239
000324  f2c40002          MOVT     r0,#0x4002            ;239
000328  f8d0a000          LDR      r10,[r0,#0]           ;239
00032c  f41a2f00          TST      r10,#0x80000          ;239
000330  bf18              IT       NE
000332  e8bd8ff0          POPNE    {r4-r11,pc}
000336  f8d0a000          LDR      r10,[r0,#0]           ;240
00033a  f44a2a00          ORR      r10,r10,#0x80000      ;240
00033e  f8c0a000          STR      r10,[r0,#0]           ;240
000342  f2400000          MOVW     r0,#:LOWER16: ||.data||;242
000346  f2c00000          MOVT     r0,#:UPPER16: ||.data||;242
00034a  60c2              STR      r2,[r0,#0xc]          ;244  ; USART4_Proc
00034c  f8db0000          LDR      r0,[r11,#0]           ;244
000350  f4401000          ORR      r0,r0,#0x200000       ;244
000354  f8cb0000          STR      r0,[r11,#0]           ;244
000358  f44f40c0          MOV      r0,#0x6000            ;247
00035c  f2c40002          MOVT     r0,#0x4002            ;247
000360  f44f1274          MOV      r2,#0x3d0000          ;247
000364  6082              STR      r2,[r0,#8]            ;247
000366  f6444204          MOV      r2,#0x4c04            ;248
00036a  f2c40200          MOVT     r2,#0x4000            ;248
00036e  6482              STR      r2,[r0,#0x48]         ;248
000370  f2400a00          MOVW     r10,#:LOWER16: ||.bss||+896;249
000374  f2c00a00          MOVT     r10,#:UPPER16: ||.bss||+896;249
000378  f8c0a04c          STR      r10,[r0,#0x4c]        ;249
00037c  f04f0a80          MOV      r10,#0x80             ;250
000380  f8c0a044          STR      r10,[r0,#0x44]        ;250
000384  6406              STR      r6,[r0,#0x40]         ;251
000386  263d              MOVS     r6,#0x3d              ;257
000388  60c6              STR      r6,[r0,#0xc]          ;257
00038a  6782              STR      r2,[r0,#0x78]         ;258
00038c  f44f6288          MOV      r2,#0x440             ;261
000390  f6c00200          MOVT     r2,#0x800             ;261
000394  6702              STR      r2,[r0,#0x70]         ;261
000396  f2400000          MOVW     r0,#:LOWER16: ||.data||+544;265
00039a  f2c00000          MOVT     r0,#:UPPER16: ||.data||+544;265
00039e  f850002c          LDR      r0,[r0,r12,LSL #2]    ;265
0003a2  f6444208          MOV      r2,#0x4c08            ;265
0003a6  fbb4f0f0          UDIV     r0,r4,r0              ;265
0003aa  f2c40200          MOVT     r2,#0x4000            ;265
0003ae  8010              STRH     r0,[r2,#0]            ;265
0003b0  f6444214          MOV      r2,#0x4c14            ;266
0003b4  f2c40200          MOVT     r2,#0x4000            ;266
0003b8  20c0              MOVS     r0,#0xc0              ;266
0003ba  8010              STRH     r0,[r2,#0]            ;266
0003bc  1f10              SUBS     r0,r2,#4              ;269
0003be  8003              STRH     r3,[r0,#0]            ;269
0003c0  5a78              LDRH     r0,[r7,r1]            ;271
0003c2  f644410c          MOV      r1,#0x4c0c            ;271
0003c6  f2c40100          MOVT     r1,#0x4000            ;271
0003ca  ea400008          ORR      r0,r0,r8              ;271
0003ce  8008              STRH     r0,[r1,#0]            ;271
0003d0  f24e0034          MOV      r0,#0xe034            ;271
0003d4  f2ce0000          MOVT     r0,#0xe000            ;271
0003d8  f8805400          STRB     r5,[r0,#0x400]        ;271
0003dc  f44f1080          MOV      r0,#0x100000          ;271
0003e0  e058              B        |L1.1172|
                  |L1.994|
0003e2  f44f5061          MOV      r0,#0x3840            ;284
0003e6  f2c40002          MOVT     r0,#0x4002            ;284
0003ea  f8d0a000          LDR      r10,[r0,#0]           ;284
0003ee  f41a1f80          TST      r10,#0x100000         ;284
0003f2  bf18              IT       NE
0003f4  e8bd8ff0          POPNE    {r4-r11,pc}
0003f8  f8d0a000          LDR      r10,[r0,#0]           ;285
0003fc  f44a1a80          ORR      r10,r10,#0x100000     ;285
000400  f8c0a000          STR      r10,[r0,#0]           ;285
000404  f2400000          MOVW     r0,#:LOWER16: ||.data||;287
000408  f2c00000          MOVT     r0,#:UPPER16: ||.data||;287
00040c  6102              STR      r2,[r0,#0x10]         ;289  ; USART5_Proc
00040e  f8db0000          LDR      r0,[r11,#0]           ;289
000412  f4401000          ORR      r0,r0,#0x200000       ;289
000416  f8cb0000          STR      r0,[r11,#0]           ;289
00041a  f44f40c0          MOV      r0,#0x6000            ;292
00041e  f2c40002          MOVT     r0,#0x4002            ;292
000422  223d              MOVS     r2,#0x3d              ;292
000424  6082              STR      r2,[r0,#8]            ;292
000426  f2450204          MOV      r2,#0x5004            ;293
00042a  f2c40200          MOVT     r2,#0x4000            ;293
00042e  6182              STR      r2,[r0,#0x18]         ;293
000430  f2400a00          MOVW     r10,#:LOWER16: ||.bss||+1152;294
000434  f2c00a00          MOVT     r10,#:UPPER16: ||.bss||+1152;294
000438  f8c0a01c          STR      r10,[r0,#0x1c]        ;294
00043c  f04f0a80          MOV      r10,#0x80             ;295
000440  f8c0a014          STR      r10,[r0,#0x14]        ;295
000444  6106              STR      r6,[r0,#0x10]         ;296
000446  f04f6674          MOV      r6,#0xf400000         ;302
00044a  60c6              STR      r6,[r0,#0xc]          ;302
00044c  f8c020c0          STR      r2,[r0,#0xc0]         ;303
000450  f44f6288          MOV      r2,#0x440             ;306
000454  f6c00200          MOVT     r2,#0x800             ;306
000458  f8c020b8          STR      r2,[r0,#0xb8]         ;306
00045c  f2400000          MOVW     r0,#:LOWER16: ||.data||+544;310
000460  f2c00000          MOVT     r0,#:UPPER16: ||.data||+544;310
000464  f850002c          LDR      r0,[r0,r12,LSL #2]    ;310
000468  fbb4f2f0          UDIV     r2,r4,r0              ;310
00046c  f44f40a0          MOV      r0,#0x5000            ;310
000470  f2c40000          MOVT     r0,#0x4000            ;310
000474  8102              STRH     r2,[r0,#8]            ;310
000476  22c0              MOVS     r2,#0xc0              ;311
000478  8282              STRH     r2,[r0,#0x14]         ;311
00047a  8203              STRH     r3,[r0,#0x10]         ;314
00047c  5a79              LDRH     r1,[r7,r1]            ;316
00047e  ea410108          ORR      r1,r1,r8              ;316
000482  8181              STRH     r1,[r0,#0xc]          ;316
000484  f24e0035          MOV      r0,#0xe035            ;316
000488  f2ce0000          MOVT     r0,#0xe000            ;316
00048c  f8805400          STRB     r5,[r0,#0x400]        ;316
000490  f44f1000          MOV      r0,#0x200000          ;316
                  |L1.1172|
000494  f8c90100          STR      r0,[r9,#0x100]        ;316
000498  e8bd8ff0          POP      {r4-r11,pc}
;;;376    
                          ENDP

                  USART1_IRQHandler PROC
;;;377    
;;;378    void USART1_IRQHandler() {
00049c  e92d43f8          PUSH     {r3-r9,lr}
;;;379    int Status;
;;;380    int Temp;	
;;;381    int TX_RX_Count = 0;	
;;;382    	
;;;383    	Status = USART1->SR;
0004a0  f44f5080          MOV      r0,#0x1000
0004a4  f2c40001          MOVT     r0,#0x4001
0004a8  8803              LDRH     r3,[r0,#0]
;;;384    	Temp   = USART1->DR;
0004aa  8880              LDRH     r0,[r0,#4]
;;;385    
;;;386    	if (Status & USART_SR_TC)	{																		/* Transmission Complete								*/
;;;387    		PeriphBB(USART1->SR,  USART_SR_TC_bit) = 0;									/* Clear TC bit													*/
0004ac  f04f0700          MOV      r7,#0
0004b0  f0130f40          TST      r3,#0x40              ;386
0004b4  f04f0500          MOV      r5,#0                 ;386
0004b8  f2c42722          MOVT     r7,#0x4222
;;;388    		PeriphBB(USART1->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
0004bc  f04f0401          MOV      r4,#1
0004c0  d006              BEQ      |L1.1232|
0004c2  61bd              STR      r5,[r7,#0x18]         ;387
0004c4  f8c74298          STR      r4,[r7,#0x298]
;;;389    		PeriphBB(USART1->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
0004c8  f8c74188          STR      r4,[r7,#0x188]
;;;390    		return;
;;;391    	}
;;;392    	
;;;393    	PeriphBB(USART1->CR1, USART_CR1_RE_bit) = 0; 									/* Reciever disable											*/
;;;394    	PeriphBB(USART1->CR3, USART_CR3_DMAR_bit) = 0; 								/* DMA Disable Receiver									*/
;;;395    	
;;;396    	TX_RX_Count = (USART_Buff_length - DMA2_Stream5->NDTR);
;;;397    	
;;;398    	/* Re-init recieve DMA channel ----------------------------------------------------------------------	*/
;;;399    	PeriphBB(DMA2_Stream5->CR, DMA_SxCR_EN_bit) = 0;							/* Disable DMA channel									*/
;;;400      while (PeriphBB(DMA2_Stream5->CR, DMA_SxCR_EN_bit));					/* Wait for DMA channel off							*/
;;;401    	
;;;402    	DMA2->HIFCR				 	= (0x3Dul << 6);													/* Clear DMA interrupr status bits			*/
;;;403    	DMA2_Stream5->M0AR 	= (unsigned int)USART1_RX_Buff;						/* Addr of recieve buffer								*/
;;;404    	DMA2_Stream5->NDTR 	= USART_Buff_length;											/* Buffer length												*/
;;;405    													
;;;406    	PeriphBB(DMA2_Stream5->CR, DMA_SxCR_EN_bit) = 1;							/* Enable DMA Channel 									*/
;;;407    
;;;408    	/* Check recieved data ------------------------------------------------------------------------------	*/
;;;409    	TX_RX_Count = USART1_Proc(TX_RX_Count, USART1_RX_Buff, USART1_TX_Buff, Status, 1);
;;;410    
;;;411    	/* Re-init transmit DMA channel ---------------------------------------------------------------------	*/
;;;412    	if (TX_RX_Count > 0) {
;;;413    		PeriphBB(DMA2_Stream7->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;414    		while (PeriphBB(DMA2_Stream7->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;415    	
;;;416    		DMA2->HIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits			*/
;;;417    		DMA2_Stream7->M0AR 	= (unsigned int)USART1_TX_Buff;					/* Addr of recieve buffer								*/
;;;418    		DMA2_Stream7->NDTR 	= TX_RX_Count;													/* Number of bytes to transfer					*/
;;;419    													
;;;420    		PeriphBB(DMA2_Stream7->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel : 								*/	
;;;421    		}	else 
;;;422    		{
;;;423    		PeriphBB(USART1->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
;;;424    		PeriphBB(USART1->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
;;;425    		}	
;;;426    }
0004cc  e8bd83f8          POP      {r3-r9,pc}
                  |L1.1232|
0004d0  f8c75188          STR      r5,[r7,#0x188]        ;393
0004d4  f8c75298          STR      r5,[r7,#0x298]        ;394
0004d8  f2464c8c          MOV      r12,#0x648c           ;396
0004dc  f2c40c02          MOVT     r12,#0x4002           ;396
0004e0  f8dc0000          LDR      r0,[r12,#0]           ;396
0004e4  f44f4110          MOV      r1,#0x9000            ;399
0004e8  f2c4214c          MOVT     r1,#0x424c            ;399
0004ec  f1c00080          RSB      r0,r0,#0x80           ;396
0004f0  f8c15100          STR      r5,[r1,#0x100]        ;399
                  |L1.1268|
0004f4  f8d12100          LDR      r2,[r1,#0x100]        ;400
0004f8  2a00              CMP      r2,#0                 ;400
0004fa  d1fb              BNE      |L1.1268|
0004fc  f246460c          MOV      r6,#0x640c            ;402
000500  f2c40602          MOVT     r6,#0x4002            ;402
000504  f44f6274          MOV      r2,#0xf40             ;402
000508  6032              STR      r2,[r6,#0]            ;402
00050a  f2400200          MOVW     r2,#:LOWER16: ||.bss||+128;403
00050e  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+128;403
000512  f2464894          MOV      r8,#0x6494            ;403
000516  f2c40802          MOVT     r8,#0x4002            ;403
00051a  f8c82000          STR      r2,[r8,#0]            ;403
00051e  2280              MOVS     r2,#0x80              ;404
000520  f8cc2000          STR      r2,[r12,#0]           ;404
000524  f8c14100          STR      r4,[r1,#0x100]        ;406
000528  f2400200          MOVW     r2,#:LOWER16: ||.bss||;409
00052c  f2c00200          MOVT     r2,#:UPPER16: ||.bss||;409
000530  f1020180          ADD      r1,r2,#0x80           ;409
000534  f2400c00          MOVW     r12,#:LOWER16: ||.data||;409
000538  f2c00c00          MOVT     r12,#:UPPER16: ||.data||;409
00053c  9400              STR      r4,[sp,#0]            ;409
00053e  f8dcc000          LDR      r12,[r12,#0]          ;409  ; USART1_Proc
000542  47e0              BLX      r12                   ;409
000544  2800              CMP      r0,#0                 ;412
000546  bfc3              ITTTE    GT                    ;413
000548  f44f4117          MOVGT    r1,#0x9700            ;413
00054c  f2c4214c          MOVTGT   r1,#0x424c            ;413
000550  600d              STRGT    r5,[r1,#0]            ;413
000552  f8c74298          STRLE    r4,[r7,#0x298]        ;423
000556  bfdc              ITT      LE                    ;424
000558  f8c74188          STRLE    r4,[r7,#0x188]        ;424
00055c  e8bd83f8          POPLE    {r3-r9,pc}
                  |L1.1376|
000560  680a              LDR      r2,[r1,#0]            ;414
000562  2a00              CMP      r2,#0                 ;414
000564  d1fc              BNE      |L1.1376|
000566  f04f6274          MOV      r2,#0xf400000         ;416
00056a  6032              STR      r2,[r6,#0]            ;416
00056c  f2400200          MOVW     r2,#:LOWER16: ||.bss||;417
000570  f2c00200          MOVT     r2,#:UPPER16: ||.bss||;417
000574  f24643c4          MOV      r3,#0x64c4            ;417
000578  f2c40302          MOVT     r3,#0x4002            ;417
00057c  601a              STR      r2,[r3,#0]            ;417
00057e  f24642bc          MOV      r2,#0x64bc            ;418
000582  f2c40202          MOVT     r2,#0x4002            ;418
000586  6010              STR      r0,[r2,#0]            ;418
000588  600c              STR      r4,[r1,#0]            ;420
00058a  e8bd83f8          POP      {r3-r9,pc}
;;;427    
                          ENDP

                  USART2_IRQHandler PROC
;;;428    void USART2_IRQHandler() {
00058e  b5f8              PUSH     {r3-r7,lr}
;;;429    int Status;
;;;430    int Temp;	
;;;431    int TX_RX_Count = 0;	
;;;432    	
;;;433    	Status = USART2->SR;
000590  f44f4088          MOV      r0,#0x4400
000594  f2c40000          MOVT     r0,#0x4000
000598  8803              LDRH     r3,[r0,#0]
;;;434    	Temp   = USART2->DR;
00059a  1d00              ADDS     r0,r0,#4
00059c  8800              LDRH     r0,[r0,#0]
;;;435    
;;;436    	if (Status & USART_SR_TC)	{																		/* Transmission Complete								*/
;;;437    		PeriphBB(USART2->SR,  USART_SR_TC_bit) = 0;									/* Clear TC bit													*/
00059e  f44f4700          MOV      r7,#0x8000
0005a2  f0130f40          TST      r3,#0x40              ;436
0005a6  f04f0600          MOV      r6,#0                 ;436
0005aa  f2c42708          MOVT     r7,#0x4208
;;;438    		PeriphBB(USART2->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
0005ae  f04f0401          MOV      r4,#1
0005b2  d005              BEQ      |L1.1472|
0005b4  61be              STR      r6,[r7,#0x18]         ;437
0005b6  f8c74298          STR      r4,[r7,#0x298]
;;;439    		PeriphBB(USART2->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
0005ba  f8c74188          STR      r4,[r7,#0x188]
;;;440    		return;
;;;441    	}
;;;442    	
;;;443    	PeriphBB(USART2->CR1, USART_CR1_RE_bit) = 0; 									/* Reciever disable											*/
;;;444    	PeriphBB(USART2->CR3, USART_CR3_DMAR_bit) = 0; 								/* DMA Disable Receiver									*/
;;;445    	
;;;446    	TX_RX_Count = (USART_Buff_length - DMA1_Stream5->NDTR);
;;;447    	
;;;448    	/* Re-init recieve DMA channel ----------------------------------------------------------------------	*/
;;;449    	PeriphBB(DMA1_Stream5->CR, DMA_SxCR_EN_bit) = 0;							/* Disable DMA channel									*/
;;;450      while (PeriphBB(DMA1_Stream5->CR, DMA_SxCR_EN_bit));					/* Wait for DMA channel off							*/
;;;451    	
;;;452    	DMA1->HIFCR				 	= (0x3Dul << 6);													/* Clear DMA interrupr status bits			*/
;;;453    	DMA1_Stream5->M0AR 	= (unsigned int)USART2_RX_Buff;						/* Addr of recieve buffer								*/
;;;454    	DMA1_Stream5->NDTR 	= USART_Buff_length;											/* Buffer length												*/
;;;455    													
;;;456    	PeriphBB(DMA1_Stream5->CR, DMA_SxCR_EN_bit) = 1;							/* Enable DMA Channel 									*/
;;;457    
;;;458    	/* Check recieved data ------------------------------------------------------------------------------	*/
;;;459    	TX_RX_Count = USART2_Proc(TX_RX_Count, USART2_RX_Buff, USART2_TX_Buff, Status, 2);
;;;460    
;;;461    	/* Re-init transmit DMA channel ---------------------------------------------------------------------	*/
;;;462    	if (TX_RX_Count > 0) {
;;;463    		PeriphBB(DMA1_Stream6->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;464    		while (PeriphBB(DMA1_Stream6->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;465    	
;;;466    		DMA1->HIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits			*/
;;;467    		DMA1_Stream6->M0AR 	= (unsigned int)USART2_TX_Buff;					/* Addr of recieve buffer								*/
;;;468    		DMA1_Stream6->NDTR 	= TX_RX_Count;													/* Number of bytes to transfer					*/
;;;469    													
;;;470    		PeriphBB(DMA1_Stream6->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel : 								*/	
;;;471    		}	else 
;;;472    		{
;;;473    		PeriphBB(USART2->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
;;;474    		PeriphBB(USART2->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
;;;475    		}	
;;;476    }
0005be  bdf8              POP      {r3-r7,pc}
                  |L1.1472|
0005c0  f8c76188          STR      r6,[r7,#0x188]        ;443
0005c4  f8c76298          STR      r6,[r7,#0x298]        ;444
0005c8  f44f45c0          MOV      r5,#0x6000            ;446
0005cc  f2c40502          MOVT     r5,#0x4002            ;446
0005d0  f8d5008c          LDR      r0,[r5,#0x8c]         ;446
0005d4  f44f5180          MOV      r1,#0x1000            ;449
0005d8  f2c4214c          MOVT     r1,#0x424c            ;449
0005dc  f1c00080          RSB      r0,r0,#0x80           ;446
0005e0  f8c16100          STR      r6,[r1,#0x100]        ;449
                  |L1.1508|
0005e4  f8d12100          LDR      r2,[r1,#0x100]        ;450
0005e8  2a00              CMP      r2,#0                 ;450
0005ea  d1fb              BNE      |L1.1508|
0005ec  f44f6274          MOV      r2,#0xf40             ;452
0005f0  60ea              STR      r2,[r5,#0xc]          ;452
0005f2  f2400200          MOVW     r2,#:LOWER16: ||.bss||+384;453
0005f6  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+384;453
0005fa  f8c52094          STR      r2,[r5,#0x94]         ;453
0005fe  2280              MOVS     r2,#0x80              ;454
000600  f8c5208c          STR      r2,[r5,#0x8c]         ;454
000604  f8c14100          STR      r4,[r1,#0x100]        ;456
000608  2102              MOVS     r1,#2                 ;459
00060a  f2400200          MOVW     r2,#:LOWER16: ||.bss||+256;459
00060e  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+256;459
000612  9100              STR      r1,[sp,#0]            ;459
000614  f1020180          ADD      r1,r2,#0x80           ;459
000618  f2400c00          MOVW     r12,#:LOWER16: ||.data||;459
00061c  f2c00c00          MOVT     r12,#:UPPER16: ||.data||;459
000620  f8dcc004          LDR      r12,[r12,#4]          ;459  ; USART2_Proc
000624  47e0              BLX      r12                   ;459
000626  2800              CMP      r0,#0                 ;462
000628  bfc3              ITTTE    GT                    ;463
00062a  f44f51a0          MOVGT    r1,#0x1400            ;463
00062e  f2c4214c          MOVTGT   r1,#0x424c            ;463
000632  600e              STRGT    r6,[r1,#0]            ;463
000634  f8c74298          STRLE    r4,[r7,#0x298]        ;473
000638  bfdc              ITT      LE                    ;474
00063a  f8c74188          STRLE    r4,[r7,#0x188]        ;474
00063e  bdf8              POPLE    {r3-r7,pc}
                  |L1.1600|
000640  680a              LDR      r2,[r1,#0]            ;464
000642  2a00              CMP      r2,#0                 ;464
000644  d1fc              BNE      |L1.1600|
000646  f44f1274          MOV      r2,#0x3d0000          ;466
00064a  60ea              STR      r2,[r5,#0xc]          ;466
00064c  f2400200          MOVW     r2,#:LOWER16: ||.bss||+256;467
000650  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+256;467
000654  f8c520ac          STR      r2,[r5,#0xac]         ;467
000658  f8c500a4          STR      r0,[r5,#0xa4]         ;468
00065c  600c              STR      r4,[r1,#0]            ;470
00065e  bdf8              POP      {r3-r7,pc}
;;;477    
                          ENDP

                  USART3_IRQHandler PROC
;;;478    
;;;479    void USART3_IRQHandler() {
000660  b5f8              PUSH     {r3-r7,lr}
;;;480    int Status;
;;;481    int Temp;	
;;;482    int USART3_TX_RX_Count = 0;	
;;;483    	
;;;484    	Status = USART3->SR;
000662  f44f4090          MOV      r0,#0x4800
000666  f2c40000          MOVT     r0,#0x4000
00066a  8803              LDRH     r3,[r0,#0]
;;;485    	Temp   = USART3->DR;
00066c  1d00              ADDS     r0,r0,#4
00066e  8800              LDRH     r0,[r0,#0]
;;;486    
;;;487    	if (Status & USART_SR_TC)	{																		/* Transmission Complete								*/
;;;488    		PeriphBB(USART3->SR,  USART_SR_TC_bit) = 0;									/* Clear TC bit													*/
000670  f04f0700          MOV      r7,#0
000674  f0130f40          TST      r3,#0x40              ;487
000678  f04f0600          MOV      r6,#0                 ;487
00067c  f2c42709          MOVT     r7,#0x4209
;;;489    		PeriphBB(USART3->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
000680  f04f0401          MOV      r4,#1
000684  d005              BEQ      |L1.1682|
000686  61be              STR      r6,[r7,#0x18]         ;488
000688  f8c74298          STR      r4,[r7,#0x298]
;;;490    		PeriphBB(USART3->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
00068c  f8c74188          STR      r4,[r7,#0x188]
;;;491    		return;
;;;492    	}
;;;493    	
;;;494    	PeriphBB(USART3->CR1, USART_CR1_RE_bit) = 0; 									/* Reciever disable											*/
;;;495    	PeriphBB(USART3->CR3, USART_CR3_DMAR_bit) = 0; 								/* DMA Disable Receiver									*/
;;;496    	
;;;497    	USART3_TX_RX_Count = (USART_Buff_length - DMA1_Stream1->NDTR);
;;;498    	
;;;499    	/* Re-init recieve DMA channel ---------------------------------------------------------------------------------------------------- */
;;;500    	PeriphBB(DMA1_Stream1->CR, DMA_SxCR_EN_bit) = 0;							/* Disable DMA channel: DMA1_Stream1->CR &= ~DMA_SxCR_EN;							*/
;;;501      while (PeriphBB(DMA1_Stream1->CR, DMA_SxCR_EN_bit));					/* Wait for DMA channel off: while (DMA1_Stream1->CR & DMA_SxCR_EN);	*/
;;;502    	
;;;503    	DMA1->LIFCR				 	= (0x3Dul << 6);													/* Clear DMA interrupr status bits			*/
;;;504    	DMA1_Stream1->M0AR 	= (unsigned int)USART3_RX_Buff;						/* Addr of recieve buffer								*/
;;;505    	DMA1_Stream1->NDTR 	= USART_Buff_length;											/* Buffer length												*/
;;;506    													
;;;507    	PeriphBB(DMA1_Stream1->CR, DMA_SxCR_EN_bit) = 1;							/* Enable DMA Channel : DMA1_Stream1->CR	|= DMA_SxCR_EN;							*/
;;;508    
;;;509    	/* Check recieved data ------------------------------------------------------------------------------------------------------------ */
;;;510    	USART3_TX_RX_Count = USART3_Proc(USART3_TX_RX_Count, USART3_RX_Buff, USART3_TX_Buff, Status, 3);
;;;511    
;;;512    	/* Re-init transmit DMA channel --------------------------------------------------------------------------------------------------- */
;;;513    	if (USART3_TX_RX_Count > 0) {
;;;514    		PeriphBB(DMA1_Stream3->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel: DMA1_Stream3->CR &= ~DMA_SxCR_EN;							*/
;;;515    		while (PeriphBB(DMA1_Stream3->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off: while (DMA3_Stream1->CR & DMA_SxCR_EN);	*/
;;;516    	
;;;517    		DMA1->LIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits			*/
;;;518    		DMA1_Stream3->M0AR 	= (unsigned int)USART3_TX_Buff;					/* Addr of recieve buffer								*/
;;;519    		DMA1_Stream3->NDTR 	= USART3_TX_RX_Count;										/* Number of bytes to transfer					*/
;;;520    													
;;;521    		PeriphBB(DMA1_Stream3->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel : DMA1_Stream3->CR	|= DMA_SxCR_EN;							*/	
;;;522    		}	else 
;;;523    		{
;;;524    		PeriphBB(USART3->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
;;;525    		PeriphBB(USART3->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
;;;526    		}	
;;;527    }
000690  bdf8              POP      {r3-r7,pc}
                  |L1.1682|
000692  f8c76188          STR      r6,[r7,#0x188]        ;494
000696  f8c76298          STR      r6,[r7,#0x298]        ;495
00069a  f44f45c0          MOV      r5,#0x6000            ;497
00069e  f2c40502          MOVT     r5,#0x4002            ;497
0006a2  6ae8              LDR      r0,[r5,#0x2c]         ;497
0006a4  f44f61a0          MOV      r1,#0x500             ;500
0006a8  f2c4214c          MOVT     r1,#0x424c            ;500
0006ac  f1c00080          RSB      r0,r0,#0x80           ;497
0006b0  600e              STR      r6,[r1,#0]            ;500
                  |L1.1714|
0006b2  680a              LDR      r2,[r1,#0]            ;501
0006b4  2a00              CMP      r2,#0                 ;501
0006b6  d1fc              BNE      |L1.1714|
0006b8  f44f6274          MOV      r2,#0xf40             ;503
0006bc  60aa              STR      r2,[r5,#8]            ;503
0006be  f2400200          MOVW     r2,#:LOWER16: ||.bss||+640;504
0006c2  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+640;504
0006c6  636a              STR      r2,[r5,#0x34]         ;504
0006c8  2280              MOVS     r2,#0x80              ;505
0006ca  62ea              STR      r2,[r5,#0x2c]         ;505
0006cc  600c              STR      r4,[r1,#0]            ;507
0006ce  2103              MOVS     r1,#3                 ;510
0006d0  f2400200          MOVW     r2,#:LOWER16: ||.bss||+512;510
0006d4  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+512;510
0006d8  9100              STR      r1,[sp,#0]            ;510
0006da  f1020180          ADD      r1,r2,#0x80           ;510
0006de  f2400c00          MOVW     r12,#:LOWER16: ||.data||;510
0006e2  f2c00c00          MOVT     r12,#:UPPER16: ||.data||;510
0006e6  f8dcc008          LDR      r12,[r12,#8]          ;510  ; USART3_Proc
0006ea  47e0              BLX      r12                   ;510
0006ec  2800              CMP      r0,#0                 ;513
0006ee  bfc3              ITTTE    GT                    ;514
0006f0  f44f6130          MOVGT    r1,#0xb00             ;514
0006f4  f2c4214c          MOVTGT   r1,#0x424c            ;514
0006f8  600e              STRGT    r6,[r1,#0]            ;514
0006fa  f8c74298          STRLE    r4,[r7,#0x298]        ;524
0006fe  bfdc              ITT      LE                    ;525
000700  f8c74188          STRLE    r4,[r7,#0x188]        ;525
000704  bdf8              POPLE    {r3-r7,pc}
                  |L1.1798|
000706  680a              LDR      r2,[r1,#0]            ;515
000708  2a00              CMP      r2,#0                 ;515
00070a  d1fc              BNE      |L1.1798|
00070c  f04f6274          MOV      r2,#0xf400000         ;517
000710  60aa              STR      r2,[r5,#8]            ;517
000712  f2400200          MOVW     r2,#:LOWER16: ||.bss||+512;518
000716  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+512;518
00071a  666a              STR      r2,[r5,#0x64]         ;518
00071c  65e8              STR      r0,[r5,#0x5c]         ;519
00071e  600c              STR      r4,[r1,#0]            ;521
000720  bdf8              POP      {r3-r7,pc}
;;;528    
                          ENDP

                  UART4_IRQHandler PROC
;;;529    void UART4_IRQHandler()  {
000722  b5f8              PUSH     {r3-r7,lr}
;;;530    int Status;
;;;531    int Temp;	
;;;532    int TX_RX_Count = 0;	
;;;533    	
;;;534    	Status = UART4->SR;
000724  f44f4098          MOV      r0,#0x4c00
000728  f2c40000          MOVT     r0,#0x4000
00072c  8803              LDRH     r3,[r0,#0]
;;;535    	Temp   = UART4->DR;
00072e  1d00              ADDS     r0,r0,#4
000730  8800              LDRH     r0,[r0,#0]
;;;536    
;;;537    	if (Status & USART_SR_TC)	{																		/* Transmission Complete								*/
;;;538    		PeriphBB(UART4->SR,  USART_SR_TC_bit) = 0;									/* Clear TC bit													*/
000732  f44f4700          MOV      r7,#0x8000
000736  f0130f40          TST      r3,#0x40              ;537
00073a  f04f0600          MOV      r6,#0                 ;537
00073e  f2c42709          MOVT     r7,#0x4209
;;;539    		PeriphBB(UART4->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
000742  f04f0401          MOV      r4,#1
000746  d005              BEQ      |L1.1876|
000748  61be              STR      r6,[r7,#0x18]         ;538
00074a  f8c74298          STR      r4,[r7,#0x298]
;;;540    		PeriphBB(UART4->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
00074e  f8c74188          STR      r4,[r7,#0x188]
;;;541    		return;
;;;542    	}
;;;543    	
;;;544    	PeriphBB(UART4->CR1, USART_CR1_RE_bit) = 0; 									/* Reciever disable											*/
;;;545    	PeriphBB(UART4->CR3, USART_CR3_DMAR_bit) = 0; 								/* DMA Disable Receiver									*/
;;;546    	
;;;547    	TX_RX_Count = (USART_Buff_length - DMA1_Stream2->NDTR);
;;;548    	
;;;549    	/* Re-init recieve DMA channel ---------------------------------------------------------------------------------------------------- */
;;;550    	PeriphBB(DMA1_Stream2->CR, DMA_SxCR_EN_bit) = 0;							/* Disable DMA channel: DMA1_Stream2->CR &= ~DMA_SxCR_EN;							*/
;;;551      while (PeriphBB(DMA1_Stream2->CR, DMA_SxCR_EN_bit));					/* Wait for DMA channel off: while (DMA1_Stream2->CR & DMA_SxCR_EN);	*/
;;;552    	
;;;553    	DMA1->LIFCR				 	= (0x3Dul << 16);													/* Clear DMA interrupr status bits			*/
;;;554    	DMA1_Stream2->M0AR 	= (unsigned int)USART4_RX_Buff;						/* Addr of recieve buffer								*/
;;;555    	DMA1_Stream2->NDTR 	= USART_Buff_length;											/* Buffer length												*/
;;;556    													
;;;557    	PeriphBB(DMA1_Stream2->CR, DMA_SxCR_EN_bit) = 1;							/* Enable DMA Channel : DMA1_Stream2->CR	|= DMA_SxCR_EN;							*/
;;;558    
;;;559    	/* Check recieved data ------------------------------------------------------------------------------------------------------------ */
;;;560    	TX_RX_Count = USART4_Proc(TX_RX_Count, USART4_RX_Buff, USART4_TX_Buff, Status, 4);
;;;561    
;;;562    	/* Re-init transmit DMA channel --------------------------------------------------------------------------------------------------- */
;;;563    	if (TX_RX_Count > 0) {
;;;564    		PeriphBB(DMA1_Stream4->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel: DMA1_Stream4->CR &= ~DMA_SxCR_EN;							*/
;;;565    		while (PeriphBB(DMA1_Stream4->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off: while (DMA4_Stream1->CR & DMA_SxCR_EN);	*/
;;;566    	
;;;567    		DMA1->HIFCR				 	= (0x3Dul << 0);												/* Clear DMA interrupr status bits			*/
;;;568    		DMA1_Stream4->M0AR 	= (unsigned int)USART4_TX_Buff;					/* Addr of recieve buffer								*/
;;;569    		DMA1_Stream4->NDTR 	= TX_RX_Count;													/* Number of bytes to transfer					*/
;;;570    													
;;;571    		PeriphBB(DMA1_Stream4->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel : DMA1_Stream4->CR	|= DMA_SxCR_EN;							*/	
;;;572    		}	else 
;;;573    		{
;;;574    		PeriphBB(UART4->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
;;;575    		PeriphBB(UART4->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
;;;576    		}	
;;;577    }
000752  bdf8              POP      {r3-r7,pc}
                  |L1.1876|
000754  f8c76188          STR      r6,[r7,#0x188]        ;544
000758  f8c76298          STR      r6,[r7,#0x298]        ;545
00075c  f44f45c0          MOV      r5,#0x6000            ;547
000760  f2c40502          MOVT     r5,#0x4002            ;547
000764  6c68              LDR      r0,[r5,#0x44]         ;547
000766  f44f6100          MOV      r1,#0x800             ;550
00076a  f2c4214c          MOVT     r1,#0x424c            ;550
00076e  f1c00080          RSB      r0,r0,#0x80           ;547
000772  600e              STR      r6,[r1,#0]            ;550
                  |L1.1908|
000774  680a              LDR      r2,[r1,#0]            ;551
000776  2a00              CMP      r2,#0                 ;551
000778  d1fc              BNE      |L1.1908|
00077a  f44f1274          MOV      r2,#0x3d0000          ;553
00077e  60aa              STR      r2,[r5,#8]            ;553
000780  f2400200          MOVW     r2,#:LOWER16: ||.bss||+896;554
000784  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+896;554
000788  64ea              STR      r2,[r5,#0x4c]         ;554
00078a  2280              MOVS     r2,#0x80              ;555
00078c  646a              STR      r2,[r5,#0x44]         ;555
00078e  600c              STR      r4,[r1,#0]            ;557
000790  2104              MOVS     r1,#4                 ;560
000792  f2400200          MOVW     r2,#:LOWER16: ||.bss||+768;560
000796  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+768;560
00079a  9100              STR      r1,[sp,#0]            ;560
00079c  f1020180          ADD      r1,r2,#0x80           ;560
0007a0  f2400c00          MOVW     r12,#:LOWER16: ||.data||;560
0007a4  f2c00c00          MOVT     r12,#:UPPER16: ||.data||;560
0007a8  f8dcc00c          LDR      r12,[r12,#0xc]        ;560  ; USART4_Proc
0007ac  47e0              BLX      r12                   ;560
0007ae  2800              CMP      r0,#0                 ;563
0007b0  bfc3              ITTTE    GT                    ;564
0007b2  f44f6160          MOVGT    r1,#0xe00             ;564
0007b6  f2c4214c          MOVTGT   r1,#0x424c            ;564
0007ba  600e              STRGT    r6,[r1,#0]            ;564
0007bc  f8c74298          STRLE    r4,[r7,#0x298]        ;574
0007c0  bfdc              ITT      LE                    ;575
0007c2  f8c74188          STRLE    r4,[r7,#0x188]        ;575
0007c6  bdf8              POPLE    {r3-r7,pc}
                  |L1.1992|
0007c8  680a              LDR      r2,[r1,#0]            ;565
0007ca  2a00              CMP      r2,#0                 ;565
0007cc  d1fc              BNE      |L1.1992|
0007ce  223d              MOVS     r2,#0x3d              ;567
0007d0  60ea              STR      r2,[r5,#0xc]          ;567
0007d2  f2400200          MOVW     r2,#:LOWER16: ||.bss||+768;568
0007d6  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+768;568
0007da  67ea              STR      r2,[r5,#0x7c]         ;568
0007dc  6768              STR      r0,[r5,#0x74]         ;569
0007de  600c              STR      r4,[r1,#0]            ;571
0007e0  bdf8              POP      {r3-r7,pc}
;;;578    
                          ENDP

                  UART5_IRQHandler PROC
;;;579    void UART5_IRQHandler()  {
0007e2  b5f8              PUSH     {r3-r7,lr}
;;;580    int Status;
;;;581    int Temp;	
;;;582    int TX_RX_Count = 0;	
;;;583    	
;;;584    	Status = UART5->SR;
0007e4  f44f40a0          MOV      r0,#0x5000
0007e8  f2c40000          MOVT     r0,#0x4000
0007ec  8803              LDRH     r3,[r0,#0]
;;;585    	Temp   = UART5->DR;
0007ee  8880              LDRH     r0,[r0,#4]
;;;586    
;;;587    	if (Status & USART_SR_TC)	{																		/* Transmission Complete								*/
;;;588    		PeriphBB(UART5->SR,  USART_SR_TC_bit) = 0;									/* Clear TC bit													*/
0007f0  f04f0700          MOV      r7,#0
0007f4  f0130f40          TST      r3,#0x40              ;587
0007f8  f04f0600          MOV      r6,#0                 ;587
0007fc  f2c4270a          MOVT     r7,#0x420a
;;;589    		PeriphBB(UART5->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
000800  f04f0401          MOV      r4,#1
000804  d005              BEQ      |L1.2066|
000806  61be              STR      r6,[r7,#0x18]         ;588
000808  f8c74298          STR      r4,[r7,#0x298]
;;;590    		PeriphBB(UART5->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
00080c  f8c74188          STR      r4,[r7,#0x188]
;;;591    		return;
;;;592    	}
;;;593    	
;;;594    	PeriphBB(UART5->CR1, USART_CR1_RE_bit) = 0; 									/* Reciever disable											*/
;;;595    	PeriphBB(UART5->CR3, USART_CR3_DMAR_bit) = 0; 								/* DMA Disable Receiver									*/
;;;596    	
;;;597    	TX_RX_Count = (USART_Buff_length - DMA1_Stream0->NDTR);
;;;598    	
;;;599    	/* Re-init recieve DMA channel ---------------------------------------------------------------------------------------------------- */
;;;600    	PeriphBB(DMA1_Stream0->CR, DMA_SxCR_EN_bit) = 0;							/* Disable DMA channel: DMA1_Stream2->CR &= ~DMA_SxCR_EN;							*/
;;;601      while (PeriphBB(DMA1_Stream0->CR, DMA_SxCR_EN_bit));					/* Wait for DMA channel off: while (DMA1_Stream2->CR & DMA_SxCR_EN);	*/
;;;602    	
;;;603    	DMA1->LIFCR				 	= (0x3Dul << 0);													/* Clear DMA interrupr status bits			*/
;;;604    	DMA1_Stream0->M0AR 	= (unsigned int)USART5_RX_Buff;						/* Addr of recieve buffer								*/
;;;605    	DMA1_Stream0->NDTR 	= USART_Buff_length;											/* Buffer length												*/
;;;606    													
;;;607    	PeriphBB(DMA1_Stream0->CR, DMA_SxCR_EN_bit) = 1;							/* Enable DMA Channel : DMA1_Stream2->CR	|= DMA_SxCR_EN;							*/
;;;608    
;;;609    	/* Check recieved data ------------------------------------------------------------------------------------------------------------ */
;;;610    	TX_RX_Count = USART5_Proc(TX_RX_Count, USART5_RX_Buff, USART5_TX_Buff, Status, 5);
;;;611    
;;;612    	/* Re-init transmit DMA channel --------------------------------------------------------------------------------------------------- */
;;;613    	if (TX_RX_Count > 0) {
;;;614    		PeriphBB(DMA1_Stream7->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel: DMA1_Stream4->CR &= ~DMA_SxCR_EN;							*/
;;;615    		while (PeriphBB(DMA1_Stream7->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off: while (DMA4_Stream1->CR & DMA_SxCR_EN);	*/
;;;616    	
;;;617    		DMA1->HIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits			*/
;;;618    		DMA1_Stream7->M0AR 	= (unsigned int)USART5_TX_Buff;					/* Addr of recieve buffer								*/
;;;619    		DMA1_Stream7->NDTR 	= TX_RX_Count;													/* Number of bytes to transfer					*/
;;;620    													
;;;621    		PeriphBB(DMA1_Stream7->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel : DMA1_Stream4->CR	|= DMA_SxCR_EN;							*/	
;;;622    		}	else 
;;;623    		{
;;;624    		PeriphBB(UART5->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
;;;625    		PeriphBB(UART5->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
;;;626    		}	
;;;627    }
000810  bdf8              POP      {r3-r7,pc}
                  |L1.2066|
000812  f8c76188          STR      r6,[r7,#0x188]        ;594
000816  f8c76298          STR      r6,[r7,#0x298]        ;595
00081a  f44f45c0          MOV      r5,#0x6000            ;597
00081e  f2c40502          MOVT     r5,#0x4002            ;597
000822  6968              LDR      r0,[r5,#0x14]         ;597
000824  2100              MOVS     r1,#0                 ;600
000826  f2c4214c          MOVT     r1,#0x424c            ;600
00082a  f1c00080          RSB      r0,r0,#0x80           ;597
00082e  f8c16200          STR      r6,[r1,#0x200]        ;600
                  |L1.2098|
000832  f8d12200          LDR      r2,[r1,#0x200]        ;601
000836  2a00              CMP      r2,#0                 ;601
000838  d1fb              BNE      |L1.2098|
00083a  223d              MOVS     r2,#0x3d              ;603
00083c  60aa              STR      r2,[r5,#8]            ;603
00083e  f2400200          MOVW     r2,#:LOWER16: ||.bss||+1152;604
000842  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+1152;604
000846  61ea              STR      r2,[r5,#0x1c]         ;604
000848  2280              MOVS     r2,#0x80              ;605
00084a  616a              STR      r2,[r5,#0x14]         ;605
00084c  f8c14200          STR      r4,[r1,#0x200]        ;607
000850  2105              MOVS     r1,#5                 ;610
000852  f2400200          MOVW     r2,#:LOWER16: ||.bss||+1024;610
000856  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+1024;610
00085a  9100              STR      r1,[sp,#0]            ;610
00085c  f1020180          ADD      r1,r2,#0x80           ;610
000860  f2400c00          MOVW     r12,#:LOWER16: ||.data||;610
000864  f2c00c00          MOVT     r12,#:UPPER16: ||.data||;610
000868  f8dcc010          LDR      r12,[r12,#0x10]       ;610  ; USART5_Proc
00086c  47e0              BLX      r12                   ;610
00086e  2800              CMP      r0,#0                 ;613
000870  bfc3              ITTTE    GT                    ;614
000872  f44f51b8          MOVGT    r1,#0x1700            ;614
000876  f2c4214c          MOVTGT   r1,#0x424c            ;614
00087a  600e              STRGT    r6,[r1,#0]            ;614
00087c  f8c74298          STRLE    r4,[r7,#0x298]        ;624
000880  bfdc              ITT      LE                    ;625
000882  f8c74188          STRLE    r4,[r7,#0x188]        ;625
000886  bdf8              POPLE    {r3-r7,pc}
                  |L1.2184|
000888  680a              LDR      r2,[r1,#0]            ;615
00088a  2a00              CMP      r2,#0                 ;615
00088c  d1fc              BNE      |L1.2184|
00088e  f04f6274          MOV      r2,#0xf400000         ;617
000892  60ea              STR      r2,[r5,#0xc]          ;617
000894  f2400200          MOVW     r2,#:LOWER16: ||.bss||+1024;618
000898  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+1024;618
00089c  f8c520c4          STR      r2,[r5,#0xc4]         ;618
0008a0  f8c500bc          STR      r0,[r5,#0xbc]         ;619
0008a4  600c              STR      r4,[r1,#0]            ;621
0008a6  bdf8              POP      {r3-r7,pc}
;;;628    void USART6_IRQHandler() {
                          ENDP

                  USART6_IRQHandler PROC
0008a8  e92d43f8          PUSH     {r3-r9,lr}
;;;629    int Status;
;;;630    int Temp;	
;;;631    int TX_RX_Count = 0;	
;;;632    	
;;;633    	Status = USART6->SR;
0008ac  f44f50a0          MOV      r0,#0x1400
0008b0  f2c40001          MOVT     r0,#0x4001
0008b4  8803              LDRH     r3,[r0,#0]
;;;634    	Temp   = USART6->DR;
0008b6  1d00              ADDS     r0,r0,#4
0008b8  8800              LDRH     r0,[r0,#0]
;;;635    
;;;636    	if (Status & USART_SR_TC)	{																		/* Transmission Complete								*/
;;;637    		PeriphBB(USART6->SR,  USART_SR_TC_bit) = 0;									/* Clear TC bit													*/
0008ba  f44f4700          MOV      r7,#0x8000
0008be  f0130f40          TST      r3,#0x40              ;636
0008c2  f04f0500          MOV      r5,#0                 ;636
0008c6  f2c42722          MOVT     r7,#0x4222
;;;638    		PeriphBB(USART6->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
0008ca  f04f0401          MOV      r4,#1
0008ce  d006              BEQ      |L1.2270|
0008d0  61bd              STR      r5,[r7,#0x18]         ;637
0008d2  f8c74298          STR      r4,[r7,#0x298]
;;;639    		PeriphBB(USART6->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
0008d6  f8c74188          STR      r4,[r7,#0x188]
;;;640    		return;
;;;641    	}
;;;642    	
;;;643    	PeriphBB(USART6->CR1, USART_CR1_RE_bit) = 0; 									/* Reciever disable											*/
;;;644    	PeriphBB(USART6->CR3, USART_CR3_DMAR_bit) = 0; 								/* DMA Disable Receiver									*/
;;;645    	
;;;646    	TX_RX_Count = (USART_Buff_length - DMA2_Stream2->NDTR);
;;;647    	
;;;648    	/* Re-init recieve DMA channel ---------------------------------------------------------------------------------------------------- */
;;;649    	PeriphBB(DMA2_Stream2->CR, DMA_SxCR_EN_bit) = 0;							/* Disable DMA channel: DMA1_Stream1->CR &= ~DMA_SxCR_EN;							*/
;;;650      while (PeriphBB(DMA2_Stream2->CR, DMA_SxCR_EN_bit));					/* Wait for DMA channel off: while (DMA1_Stream1->CR & DMA_SxCR_EN);	*/
;;;651    	
;;;652    	DMA2->LIFCR				 	= (0x3Dul << 16);													/* Clear DMA interrupr status bits			*/
;;;653    	DMA2_Stream2->M0AR 	= (unsigned int)USART6_RX_Buff;						/* Addr of recieve buffer								*/
;;;654    	DMA2_Stream2->NDTR 	= USART_Buff_length;											/* Buffer length												*/
;;;655    													
;;;656    	PeriphBB(DMA2_Stream2->CR, DMA_SxCR_EN_bit) = 1;							/* Enable DMA Channel : DMA1_Stream1->CR	|= DMA_SxCR_EN;							*/
;;;657    
;;;658    	/* Check recieved data ------------------------------------------------------------------------------------------------------------ */
;;;659    	TX_RX_Count = USART6_Proc(TX_RX_Count, USART6_RX_Buff, USART6_TX_Buff, Status, 6);
;;;660    
;;;661    	/* Re-init transmit DMA channel --------------------------------------------------------------------------------------------------- */
;;;662    	if (TX_RX_Count > 0) {
;;;663    		PeriphBB(DMA2_Stream6->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel: DMA1_Stream3->CR &= ~DMA_SxCR_EN;							*/
;;;664    		while (PeriphBB(DMA2_Stream6->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off: while (DMA3_Stream1->CR & DMA_SxCR_EN);	*/
;;;665    	
;;;666    		DMA2->HIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits			*/
;;;667    		DMA2_Stream6->M0AR 	= (unsigned int)USART6_TX_Buff;					/* Addr of recieve buffer								*/
;;;668    		DMA2_Stream6->NDTR 	= TX_RX_Count;													/* Number of bytes to transfer					*/
;;;669    													
;;;670    		PeriphBB(DMA2_Stream6->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel : DMA1_Stream3->CR	|= DMA_SxCR_EN;							*/	
;;;671    		}	else 
;;;672    		{
;;;673    		PeriphBB(USART6->CR3, USART_CR3_DMAR_bit) = 1; 							/* DMA Enable Receiver									*/
;;;674    		PeriphBB(USART6->CR1, USART_CR1_RE_bit) = 1; 								/* Reciever enable											*/
;;;675    		}	
;;;676    }
0008da  e8bd83f8          POP      {r3-r9,pc}
                  |L1.2270|
0008de  f8c75188          STR      r5,[r7,#0x188]        ;643
0008e2  f8c75298          STR      r5,[r7,#0x298]        ;644
0008e6  f2464c44          MOV      r12,#0x6444           ;646
0008ea  f2c40c02          MOVT     r12,#0x4002           ;646
0008ee  f8dc0000          LDR      r0,[r12,#0]           ;646
0008f2  f44f4108          MOV      r1,#0x8800            ;649
0008f6  f2c4214c          MOVT     r1,#0x424c            ;649
0008fa  f1c00080          RSB      r0,r0,#0x80           ;646
0008fe  600d              STR      r5,[r1,#0]            ;649
                  |L1.2304|
000900  680a              LDR      r2,[r1,#0]            ;650
000902  2a00              CMP      r2,#0                 ;650
000904  d1fc              BNE      |L1.2304|
000906  f2464208          MOV      r2,#0x6408            ;652
00090a  f2c40202          MOVT     r2,#0x4002            ;652
00090e  f44f1674          MOV      r6,#0x3d0000          ;652
000912  6016              STR      r6,[r2,#0]            ;652
000914  f2400200          MOVW     r2,#:LOWER16: ||.bss||+1408;653
000918  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+1408;653
00091c  f246484c          MOV      r8,#0x644c            ;653
000920  f2c40802          MOVT     r8,#0x4002            ;653
000924  f8c82000          STR      r2,[r8,#0]            ;653
000928  2280              MOVS     r2,#0x80              ;654
00092a  f8cc2000          STR      r2,[r12,#0]           ;654
00092e  600c              STR      r4,[r1,#0]            ;656
000930  2106              MOVS     r1,#6                 ;659
000932  f2400200          MOVW     r2,#:LOWER16: ||.bss||+1280;659
000936  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+1280;659
00093a  9100              STR      r1,[sp,#0]            ;659
00093c  f1020180          ADD      r1,r2,#0x80           ;659
000940  f2400c00          MOVW     r12,#:LOWER16: ||.data||;659
000944  f2c00c00          MOVT     r12,#:UPPER16: ||.data||;659
000948  f8dcc014          LDR      r12,[r12,#0x14]       ;659  ; USART6_Proc
00094c  47e0              BLX      r12                   ;659
00094e  2800              CMP      r0,#0                 ;662
000950  bfc3              ITTTE    GT                    ;663
000952  f44f4114          MOVGT    r1,#0x9400            ;663
000956  f2c4214c          MOVTGT   r1,#0x424c            ;663
00095a  600d              STRGT    r5,[r1,#0]            ;663
00095c  f8c74298          STRLE    r4,[r7,#0x298]        ;673
000960  bfdc              ITT      LE                    ;674
000962  f8c74188          STRLE    r4,[r7,#0x188]        ;674
000966  e8bd83f8          POPLE    {r3-r9,pc}
                  |L1.2410|
00096a  680a              LDR      r2,[r1,#0]            ;664
00096c  2a00              CMP      r2,#0                 ;664
00096e  d1fc              BNE      |L1.2410|
000970  f246420c          MOV      r2,#0x640c            ;666
000974  f2c40202          MOVT     r2,#0x4002            ;666
000978  6016              STR      r6,[r2,#0]            ;666
00097a  f2400200          MOVW     r2,#:LOWER16: ||.bss||+1280;667
00097e  f2c00200          MOVT     r2,#:UPPER16: ||.bss||+1280;667
000982  f24643ac          MOV      r3,#0x64ac            ;667
000986  f2c40302          MOVT     r3,#0x4002            ;667
00098a  601a              STR      r2,[r3,#0]            ;667
00098c  f24642a4          MOV      r2,#0x64a4            ;668
000990  f2c40202          MOVT     r2,#0x4002            ;668
000994  6010              STR      r0,[r2,#0]            ;668
000996  600c              STR      r4,[r1,#0]            ;670
000998  e8bd83f8          POP      {r3-r9,pc}
;;;677    
                          ENDP

                  MasterSend PROC
;;;678    int  MasterSend(int Port, int TX_Count, int SendMode, unsigned char *TX_Buff) {
00099c  2900              CMP      r1,#0
;;;679    	if (TX_Count == 0) return 0;
00099e  bf04              ITT      EQ
0009a0  2000              MOVEQ    r0,#0
;;;680    
;;;681    	switch (Port)	{
;;;682    #if (USART1_PRESENT == YES)			
;;;683    		case 1:	{	if ((RCC->APB2ENR & RCC_APB2ENR_USART1EN) == 0) return 0;		/* Port not init												*/
;;;684    			
;;;685    							PeriphBB(DMA2_Stream7->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;686    							while (PeriphBB(DMA2_Stream7->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;687    	
;;;688    							DMA2->HIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits			*/
;;;689    							DMA2_Stream7->M0AR 	= (unsigned int)TX_Buff;								/* Addr of transmite buffer							*/
;;;690    							DMA2_Stream7->NDTR 	= TX_Count;															/* Number of bytes to transfer					*/
;;;691    													
;;;692    							PeriphBB(DMA2_Stream7->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel										*/
;;;693    						  return 1;
;;;694    						} break;
;;;695    #endif			
;;;696    #if (USART2_PRESENT == YES)			
;;;697    		case 2:	{ if ((RCC->APB1ENR & RCC_APB1ENR_USART2EN) == 0) return 0;		/* Port not init												*/
;;;698    			
;;;699    							PeriphBB(DMA1_Stream6->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;700    							while (PeriphBB(DMA1_Stream6->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;701    	
;;;702    							DMA1->HIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits			*/
;;;703    							DMA1_Stream6->M0AR 	= (unsigned int)TX_Buff;								/* Addr of transmite buffer							*/
;;;704    							DMA1_Stream6->NDTR 	= TX_Count;															/* Number of bytes to transfer					*/
;;;705    													
;;;706    							PeriphBB(DMA1_Stream6->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel										*/
;;;707    						  return 1;
;;;708    						} break;
;;;709    #endif
;;;710    #if (USART3_PRESENT == YES)			
;;;711    		case 3:	{ if ((RCC->APB1ENR & RCC_APB1ENR_USART3EN) == 0) return 0;		/* Port not init												*/
;;;712    			
;;;713    							PeriphBB(DMA1_Stream3->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;714    							while (PeriphBB(DMA1_Stream3->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;715    	
;;;716    							DMA1->LIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits			*/
;;;717    							DMA1_Stream3->M0AR 	= (unsigned int)TX_Buff;								/* Addr of transmite buffer							*/
;;;718    							DMA1_Stream3->NDTR 	= TX_Count;															/* Number of bytes to transfer					*/
;;;719    													
;;;720    							PeriphBB(DMA1_Stream3->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel										*/
;;;721    						  return 1;
;;;722    						} break;
;;;723    #endif
;;;724    #if (UART4_PRESENT  == YES)			
;;;725    		case 4:	{ if ((RCC->APB1ENR & RCC_APB1ENR_UART4EN) == 0) return 0;		/* Port not init												*/
;;;726    
;;;727    							PeriphBB(DMA1_Stream4->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;728    							while (PeriphBB(DMA1_Stream4->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;729    	
;;;730    							DMA1->HIFCR				 	= (0x3Dul << 0);												/* Clear DMA interrupr status bits			*/
;;;731    							DMA1_Stream4->M0AR 	= (unsigned int)TX_Buff;								/* Addr of transmite buffer							*/
;;;732    							DMA1_Stream4->NDTR 	= TX_Count;															/* Number of bytes to transfer					*/
;;;733    
;;;734    //							#if (UART4_DE_PRESENT == YES)
;;;735    //								UART4_DE_Ena();																						/**/
;;;736    //							#endif
;;;737    			
;;;738    							PeriphBB(DMA1_Stream4->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel										*/
;;;739    						  return 1;
;;;740    						} break;
;;;741    #endif
;;;742    #if (UART5_PRESENT  == YES)			
;;;743    		case 5:	{ if ((RCC->APB1ENR & RCC_APB1ENR_UART5EN) == 0) return 0;		/* Port not init												*/
;;;744    
;;;745    							PeriphBB(DMA1_Stream7->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;746    							while (PeriphBB(DMA1_Stream7->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;747    	
;;;748    							DMA1->HIFCR				 	= (0x3Dul << 22);												/* Clear DMA interrupr status bits			*/
;;;749    							DMA1_Stream7->M0AR 	= (unsigned int)TX_Buff;								/* Addr of transmite buffer							*/
;;;750    							DMA1_Stream7->NDTR 	= TX_Count;															/* Number of bytes to transfer					*/
;;;751    
;;;752    //							#if (UART5_DE_PRESENT == YES)
;;;753    //								UART5_DE_Ena();																						/**/
;;;754    //							#endif
;;;755    			
;;;756    							PeriphBB(DMA1_Stream7->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel										*/
;;;757    						  return 1;
;;;758    						} break;
;;;759    #endif						
;;;760    #if (USART6_PRESENT == YES)
;;;761    		case 6:	{ if ((RCC->APB2ENR & RCC_APB2ENR_USART6EN) == 0) return 0;		/* Port not init												*/
;;;762    			
;;;763    							PeriphBB(DMA2_Stream6->CR, DMA_SxCR_EN_bit) = 0;						/* Disabel DMA channel									*/
;;;764    							while (PeriphBB(DMA2_Stream6->CR, DMA_SxCR_EN_bit));				/* Wait for DMA channel off							*/
;;;765    	
;;;766    							DMA2->HIFCR				 	= (0x3Dul << 16);												/* Clear DMA interrupr status bits			*/
;;;767    							DMA2_Stream6->M0AR 	= (unsigned int)TX_Buff;								/* Addr of transmite buffer							*/
;;;768    							DMA2_Stream6->NDTR 	= TX_Count;															/* Number of bytes to transfer					*/
;;;769    													
;;;770    							PeriphBB(DMA2_Stream6->CR, DMA_SxCR_EN_bit) = 1;						/* Enable DMA Channel										*/
;;;771    						  return 1;
;;;772    						} break;
;;;773    #endif			
;;;774    		default: return 0;
;;;775    	}
;;;776    }
0009a2  4770              BXEQ     lr
0009a4  b4f0              PUSH     {r4-r7}               ;678
0009a6  2200              MOVS     r2,#0                 ;678
0009a8  f44f5561          MOV      r5,#0x3840            ;697
0009ac  f44f44c0          MOV      r4,#0x6000            ;702
0009b0  f04f0c01          MOV      r12,#1                ;678
0009b4  f04f6674          MOV      r6,#0xf400000         ;688
0009b8  f2c40502          MOVT     r5,#0x4002            ;697
0009bc  f2c40402          MOVT     r4,#0x4002            ;702
0009c0  2806              CMP      r0,#6                 ;681
0009c2  d275              BCS      |L1.2736|
0009c4  e8dff000          TBB      [pc,r0]               ;681
0009c8  8e032a45          DCB      0x8e,0x03,0x2a,0x45
0009cc  5c75              DCB      0x5c,0x75
0009ce  f6430044          MOV      r0,#0x3844            ;683
0009d2  f2c40002          MOVT     r0,#0x4002            ;683
0009d6  6800              LDR      r0,[r0,#0]            ;683
0009d8  f0100010          ANDS     r0,r0,#0x10           ;683
0009dc  bf1d              ITTTE    NE                    ;685
0009de  f44f4017          MOVNE    r0,#0x9700            ;685
0009e2  f2c4204c          MOVTNE   r0,#0x424c            ;685
0009e6  6002              STRNE    r2,[r0,#0]            ;685
0009e8  bcf0              POPEQ    {r4-r7}
0009ea  bf08              IT       EQ
0009ec  4770              BXEQ     lr
                  |L1.2542|
0009ee  6802              LDR      r2,[r0,#0]            ;686
0009f0  2a00              CMP      r2,#0                 ;686
0009f2  d1fc              BNE      |L1.2542|
0009f4  f246420c          MOV      r2,#0x640c            ;688
0009f8  f2c40202          MOVT     r2,#0x4002            ;688
0009fc  6016              STR      r6,[r2,#0]            ;688
0009fe  f24642c4          MOV      r2,#0x64c4            ;689
000a02  f2c40202          MOVT     r2,#0x4002            ;689
000a06  6013              STR      r3,[r2,#0]            ;689
000a08  f24642bc          MOV      r2,#0x64bc            ;690
000a0c  f2c40202          MOVT     r2,#0x4002            ;690
000a10  6011              STR      r1,[r2,#0]            ;690
000a12  f8c0c000          STR      r12,[r0,#0]           ;692
000a16  bcf0              POP      {r4-r7}
000a18  2001              MOVS     r0,#1                 ;693
000a1a  4770              BX       lr
000a1c  6828              LDR      r0,[r5,#0]            ;697
000a1e  f4103000          ANDS     r0,r0,#0x20000        ;697
000a22  bf1d              ITTTE    NE                    ;699
000a24  f44f50a0          MOVNE    r0,#0x1400            ;699
000a28  f2c4204c          MOVTNE   r0,#0x424c            ;699
000a2c  6002              STRNE    r2,[r0,#0]            ;699
000a2e  bcf0              POPEQ    {r4-r7}
000a30  bf08              IT       EQ
000a32  4770              BXEQ     lr
                  |L1.2612|
000a34  6802              LDR      r2,[r0,#0]            ;700
000a36  2a00              CMP      r2,#0                 ;700
000a38  d1fc              BNE      |L1.2612|
000a3a  f44f1274          MOV      r2,#0x3d0000          ;702
000a3e  60e2              STR      r2,[r4,#0xc]          ;702
000a40  f8c430ac          STR      r3,[r4,#0xac]         ;703
000a44  f8c410a4          STR      r1,[r4,#0xa4]         ;704
000a48  f8c0c000          STR      r12,[r0,#0]           ;706
000a4c  bcf0              POP      {r4-r7}
000a4e  2001              MOVS     r0,#1                 ;707
000a50  4770              BX       lr
000a52  6828              LDR      r0,[r5,#0]            ;711
000a54  f4102080          ANDS     r0,r0,#0x40000        ;711
000a58  bf1d              ITTTE    NE                    ;713
000a5a  f44f6030          MOVNE    r0,#0xb00             ;713
000a5e  f2c4204c          MOVTNE   r0,#0x424c            ;713
000a62  6002              STRNE    r2,[r0,#0]            ;713
000a64  bcf0              POPEQ    {r4-r7}
000a66  bf08              IT       EQ
000a68  4770              BXEQ     lr
                  |L1.2666|
000a6a  6802              LDR      r2,[r0,#0]            ;714
000a6c  2a00              CMP      r2,#0                 ;714
000a6e  d1fc              BNE      |L1.2666|
000a70  60a6              STR      r6,[r4,#8]            ;716
000a72  6663              STR      r3,[r4,#0x64]         ;717
000a74  65e1              STR      r1,[r4,#0x5c]         ;718
000a76  f8c0c000          STR      r12,[r0,#0]           ;720
000a7a  bcf0              POP      {r4-r7}
000a7c  2001              MOVS     r0,#1                 ;721
000a7e  4770              BX       lr
000a80  6828              LDR      r0,[r5,#0]            ;725
000a82  f4102000          ANDS     r0,r0,#0x80000        ;725
000a86  bf1d              ITTTE    NE                    ;727
000a88  f44f6060          MOVNE    r0,#0xe00             ;727
000a8c  f2c4204c          MOVTNE   r0,#0x424c            ;727
000a90  6002              STRNE    r2,[r0,#0]            ;727
000a92  bcf0              POPEQ    {r4-r7}
000a94  bf08              IT       EQ
000a96  4770              BXEQ     lr
                  |L1.2712|
000a98  6802              LDR      r2,[r0,#0]            ;728
000a9a  2a00              CMP      r2,#0                 ;728
000a9c  d1fc              BNE      |L1.2712|
000a9e  223d              MOVS     r2,#0x3d              ;730
000aa0  60e2              STR      r2,[r4,#0xc]          ;730
000aa2  67e3              STR      r3,[r4,#0x7c]         ;731
000aa4  6761              STR      r1,[r4,#0x74]         ;732
000aa6  f8c0c000          STR      r12,[r0,#0]           ;738
000aaa  bcf0              POP      {r4-r7}
000aac  2001              MOVS     r0,#1                 ;739
000aae  4770              BX       lr
                  |L1.2736|
000ab0  e018              B        |L1.2788|
000ab2  6828              LDR      r0,[r5,#0]            ;743
000ab4  f4101080          ANDS     r0,r0,#0x100000       ;743
000ab8  bf1d              ITTTE    NE                    ;745
000aba  f44f50b8          MOVNE    r0,#0x1700            ;745
000abe  f2c4204c          MOVTNE   r0,#0x424c            ;745
000ac2  6002              STRNE    r2,[r0,#0]            ;745
000ac4  bcf0              POPEQ    {r4-r7}
000ac6  bf08              IT       EQ
000ac8  4770              BXEQ     lr
                  |L1.2762|
000aca  6802              LDR      r2,[r0,#0]            ;746
000acc  2a00              CMP      r2,#0                 ;746
000ace  d1fc              BNE      |L1.2762|
000ad0  60e6              STR      r6,[r4,#0xc]          ;748
000ad2  f8c430c4          STR      r3,[r4,#0xc4]         ;749
000ad6  f8c410bc          STR      r1,[r4,#0xbc]         ;750
000ada  f8c0c000          STR      r12,[r0,#0]           ;756
000ade  bcf0              POP      {r4-r7}
000ae0  2001              MOVS     r0,#1                 ;757
000ae2  4770              BX       lr
                  |L1.2788|
000ae4  bcf0              POP      {r4-r7}
000ae6  2000              MOVS     r0,#0                 ;774
000ae8  4770              BX       lr
;;;777    
                          ENDP

                  Modbus03 PROC
;;;780    /********************************************************************************************************************************************/
;;;781    int Modbus03(int Count, unsigned char *RxBuff, unsigned char *TxBuff, unsigned short *DataAddr, unsigned int DataLen) {
000aea  b530              PUSH     {r4,r5,lr}
000aec  4614              MOV      r4,r2
;;;782    int i;
;;;783    int j;
;;;784    int k;	
;;;785    unsigned int Data;
;;;786    unsigned int Addr;	
;;;787    
;;;788    	if (Count!=8) return ModbusErr(0x03, RxBuff, TxBuff);
000aee  f8ddc00c          LDR      r12,[sp,#0xc]
000af2  2808              CMP      r0,#8
000af4  d004              BEQ      |L1.2816|
000af6  e8bd4030          POP      {r4,r5,lr}
000afa  2003              MOVS     r0,#3
000afc  f7ffbffe          B.W      ModbusErr
                  |L1.2816|
;;;789    	
;;;790    	//Quantity of Registers 																				61
;;;791    		 i 	= (RxBuff[4] << 8) | RxBuff[5];	if ((i == 0) || (i > ((USART_Buff_length - 5) >> 1) )) return ModbusErr(0x02, RxBuff, TxBuff);
000b00  8888              LDRH     r0,[r1,#4]
000b02  ba40              REV16    r0,r0
000b04  b108              CBZ      r0,|L1.2826|
000b06  283d              CMP      r0,#0x3d
000b08  dd04              BLE      |L1.2836|
                  |L1.2826|
000b0a  e8bd4030          POP      {r4,r5,lr}
000b0e  2002              MOVS     r0,#2
000b10  f7ffbffe          B.W      ModbusErr
                  |L1.2836|
;;;792    	Addr	= (RxBuff[2] << 8) | RxBuff[3];	if ((Addr + i) > (DataLen>>1)) return ModbusErr(0x02, RxBuff, TxBuff);						
000b14  884a              LDRH     r2,[r1,#2]
000b16  ba52              REV16    r2,r2
;;;793    		
;;;794    	DataAddr += Addr;																/*     */
;;;795    
;;;796    	((short *)TxBuff)[0] = ((short *)RxBuff)[0];
;;;797    
;;;798    	TxBuff[2] = (i << 1);														/* -   */
;;;799    					j = 3;
;;;800    					k = 3 + (i << 1);												/**/
;;;801    
;;;802    	/*     ,            		*/
;;;803    	if ((unsigned int)DataAddr & 0x02) {
;;;804    		Data = (DataAddr++)[0]; 
;;;805    		TxBuff[j++] = Data>>8;
;;;806    		TxBuff[j++] = Data;
;;;807    	}
;;;808    
;;;809    	/*     																																													*/
;;;810    	for ( ; j<k ; )	{
;;;811    		Data = *((unsigned int *)DataAddr++);					/*    =  		*/
;;;812    		DataAddr++;		
;;;813    		((unsigned int*)(&TxBuff[j]))[0] = ((Data & 0xFF00FF00) >> 8) | ((Data & 0x00FF00FF) << 8);
;;;814    		j += 4;
;;;815    	} 
;;;816    
;;;817    	Data = CalcCRC(k, TxBuff);
;;;818    	TxBuff[k++] = Data;
;;;819    	TxBuff[k++]	= Data>>8;
;;;820    
;;;821    	return k;
;;;822    }
000b18  fa10f582          UXTAH    r5,r0,r2
000b1c  ebb50f5c          CMP      r5,r12,LSR #1         ;792
000b20  d905              BLS      |L1.2862|
000b22  4622              MOV      r2,r4                 ;792
000b24  e8bd4030          POP      {r4,r5,lr}            ;792
000b28  2002              MOVS     r0,#2                 ;792
000b2a  f7ffbffe          B.W      ModbusErr
                  |L1.2862|
000b2e  8809              LDRH     r1,[r1,#0]            ;796
000b30  8021              STRH     r1,[r4,#0]            ;796
000b32  0041              LSLS     r1,r0,#1              ;798
000b34  eb030342          ADD      r3,r3,r2,LSL #1       ;794
000b38  f04f0c03          MOV      r12,#3                ;799
000b3c  70a1              STRB     r1,[r4,#2]            ;798
000b3e  eb0c0540          ADD      r5,r12,r0,LSL #1      ;800
000b42  f0130f02          TST      r3,#2                 ;803
000b46  d006              BEQ      |L1.2902|
000b48  f8330b02          LDRH     r0,[r3],#2            ;804
000b4c  f04f0c05          MOV      r12,#5                ;806
000b50  0a01              LSRS     r1,r0,#8              ;805
000b52  70e1              STRB     r1,[r4,#3]            ;805
000b54  7120              STRB     r0,[r4,#4]            ;806
                  |L1.2902|
000b56  45ac              CMP      r12,r5                ;810
000b58  da08              BGE      |L1.2924|
                  |L1.2906|
000b5a  f8530b04          LDR      r0,[r3],#4            ;811
000b5e  ba40              REV16    r0,r0                 ;813
000b60  f844000c          STR      r0,[r4,r12]           ;813
000b64  f10c0c04          ADD      r12,r12,#4            ;813
000b68  45ac              CMP      r12,r5                ;810
000b6a  dbf6              BLT      |L1.2906|
                  |L1.2924|
000b6c  4621              MOV      r1,r4                 ;817
000b6e  4628              MOV      r0,r5                 ;817
000b70  f7fffffe          BL       CalcCRC
000b74  4601              MOV      r1,r0                 ;817
000b76  5560              STRB     r0,[r4,r5]            ;818
000b78  1c68              ADDS     r0,r5,#1              ;818
000b7a  0a09              LSRS     r1,r1,#8              ;819
000b7c  5421              STRB     r1,[r4,r0]            ;819
000b7e  1ca8              ADDS     r0,r5,#2              ;819
000b80  bd30              POP      {r4,r5,pc}
;;;823    
                          ENDP

                  Modbus06 PROC
;;;824    int Modbus06(int Count, unsigned char *RxBuff, unsigned char *TxBuff, unsigned short *DataAddr, unsigned int DataLen) {
000b82  b410              PUSH     {r4}
;;;825    unsigned   int Addr;	
;;;826    unsigned short Data;
;;;827    	
;;;828    	if (Count!=8) return ModbusErr(0x03, RxBuff, TxBuff);
000b84  2808              CMP      r0,#8
000b86  f8ddc004          LDR      r12,[sp,#4]
000b8a  d003              BEQ      |L1.2964|
000b8c  bc10              POP      {r4}
000b8e  2003              MOVS     r0,#3
000b90  f7ffbffe          B.W      ModbusErr
                  |L1.2964|
;;;829    	
;;;830    	Addr = (RxBuff[2] << 8) | RxBuff[3];	if (Addr > ((DataLen>>1)-1)) return ModbusErr(0x02, RxBuff, TxBuff);
000b94  8848              LDRH     r0,[r1,#2]
000b96  f04f34ff          MOV      r4,#0xffffffff
000b9a  ba40              REV16    r0,r0
000b9c  eb040c5c          ADD      r12,r4,r12,LSR #1
000ba0  4584              CMP      r12,r0
000ba2  d203              BCS      |L1.2988|
000ba4  bc10              POP      {r4}
000ba6  2002              MOVS     r0,#2
000ba8  f7ffbffe          B.W      ModbusErr
                  |L1.2988|
;;;831    	Data = (RxBuff[4] << 8) | RxBuff[5]; 	
000bac  f8b1c004          LDRH     r12,[r1,#4]
000bb0  fa9cfc9c          REV16    r12,r12
;;;832    
;;;833    	DataAddr += Addr;
;;;834     *DataAddr  = Data;
000bb4  f823c010          STRH     r12,[r3,r0,LSL #1]
;;;835    
;;;836    	((int *)TxBuff)[0] = ((int *)RxBuff)[0];
000bb8  6808              LDR      r0,[r1,#0]
;;;837    	((int *)TxBuff)[1] = ((int *)RxBuff)[1];
000bba  6010              STR      r0,[r2,#0]
000bbc  6848              LDR      r0,[r1,#4]
;;;838    	return 8;
000bbe  6050              STR      r0,[r2,#4]
;;;839    }
000bc0  bc10              POP      {r4}
000bc2  2008              MOVS     r0,#8                 ;838
000bc4  4770              BX       lr
;;;840    
                          ENDP

                  Modbus08 PROC
;;;841    int Modbus08(int Count, unsigned char *RxBuff, unsigned char *TxBuff, unsigned short *DataAddr, unsigned int DataLen) {
000bc6  2808              CMP      r0,#8
000bc8  d002              BEQ      |L1.3024|
;;;842    	if (Count!=8) return ModbusErr(0x03, RxBuff, TxBuff);
000bca  2003              MOVS     r0,#3
000bcc  f7ffbffe          B.W      ModbusErr
                  |L1.3024|
;;;843    	
;;;844    	((int *)TxBuff)[0] = ((int *)RxBuff)[0];
000bd0  6808              LDR      r0,[r1,#0]
;;;845    	((int *)TxBuff)[1] = ((int *)RxBuff)[1];
000bd2  6010              STR      r0,[r2,#0]
000bd4  6848              LDR      r0,[r1,#4]
;;;846    	return 8;	
000bd6  6050              STR      r0,[r2,#4]
000bd8  2008              MOVS     r0,#8
;;;847    }	
000bda  4770              BX       lr
;;;848    
                          ENDP

                  Modbus16 PROC
;;;849    int Modbus16(int Count, unsigned char *RxBuff, unsigned char *TxBuff, unsigned short *DataAddr, unsigned int DataLen) {
000bdc  b530              PUSH     {r4,r5,lr}
000bde  4614              MOV      r4,r2
;;;850    				 int j;
;;;851    				 int i;
;;;852    unsigned int Addr;	
;;;853    	
;;;854    	if (Count<11) return ModbusErr(0x03, RxBuff, TxBuff);
000be0  f8ddc00c          LDR      r12,[sp,#0xc]
000be4  280b              CMP      r0,#0xb
000be6  da04              BGE      |L1.3058|
000be8  e8bd4030          POP      {r4,r5,lr}
000bec  2003              MOVS     r0,#3
000bee  f7ffbffe          B.W      ModbusErr
                  |L1.3058|
;;;855    	
;;;856    	   i = (RxBuff[4] << 8) | (RxBuff[5] << 0);		if (i == 0) return ModbusErr(0x02, RxBuff, TxBuff);
000bf2  8888              LDRH     r0,[r1,#4]
000bf4  ba40              REV16    r0,r0
000bf6  b160              CBZ      r0,|L1.3090|
;;;857    	Addr = (RxBuff[2] << 8) | (RxBuff[3] << 0);		if ((Addr + i) > (DataLen>>1)) return ModbusErr(0x02, RxBuff, TxBuff);
000bf8  884a              LDRH     r2,[r1,#2]
000bfa  ba52              REV16    r2,r2
;;;858    	
;;;859    
;;;860    /*  */ 
;;;861    	if ((Addr == 0x0259) && (i == 3)) {
;;;862    		StdPrms.SetTime = RxBuff[8]  | (RxBuff[10] << 8) | (RxBuff[12] << 16);
;;;863    
;;;864    		((int *)TxBuff)[0] = ((int *)RxBuff)[0];
;;;865    		((int *)TxBuff)[1] = ((int *)RxBuff)[1];
;;;866    		
;;;867    		*((short *)(&TxBuff[6])) = CalcCRC(6, TxBuff);
;;;868    		return 8;
;;;869    	}
;;;870    
;;;871    	if ((Addr == 0x025D) && (i == 3)) {
;;;872    		StdPrms.SetDate = RxBuff[8]  | (RxBuff[10] << 8) | (RxBuff[12] << 16);
;;;873    
;;;874    		((int *)TxBuff)[0] = ((int *)RxBuff)[0];
;;;875    		((int *)TxBuff)[1] = ((int *)RxBuff)[1];
;;;876    		
;;;877    		*((short *)(&TxBuff[6])) = CalcCRC(6, TxBuff);
;;;878    		return 8;
;;;879    	}
;;;880    
;;;881    	if ((Addr == 0x0252) && (i == 1)) {
;;;882    
;;;883    		((int *)TxBuff)[0] = ((int *)RxBuff)[0];
;;;884    		((int *)TxBuff)[1] = ((int *)RxBuff)[1];
;;;885    		
;;;886    		*((short *)(&TxBuff[6])) = CalcCRC(6, TxBuff);
;;;887    		return 8;
;;;888    	}
;;;889    	
;;;890    /* */	
;;;891    
;;;892     	
;;;893    	DataAddr += Addr;												/*      	*/
;;;894    				 j	= 7;													/*     		*/
;;;895    
;;;896    	/*     ,            		*/
;;;897    	if ((unsigned int)DataAddr & 0x02) {
;;;898    	  *DataAddr++ = (RxBuff[j+0] << 8) | (RxBuff[j+1] << 0);
;;;899    		j += 2;
;;;900    		i -= 1;
;;;901    		}
;;;902    
;;;903    	for ( ; i>=2 ; )	{
;;;904    		*((unsigned int *)DataAddr++) = ((RxBuff[j+0] << 8) | (RxBuff[j+1] << 0)) | ((RxBuff[j+2] << 24) | (RxBuff[j+3] << 16));
;;;905    		DataAddr++;
;;;906    		j += 4;
;;;907    		i -= 2;
;;;908    		}	
;;;909    		
;;;910    	if (i == 1) {
;;;911    	  *DataAddr++ = (RxBuff[j+0] << 8) | (RxBuff[j+1] << 0);
;;;912    		j += 2;
;;;913    		i -= 1;
;;;914    		}
;;;915    	
;;;916    	((int *)TxBuff)[0] = ((int *)RxBuff)[0];
;;;917    	((int *)TxBuff)[1] = ((int *)RxBuff)[1];
;;;918    		
;;;919    	*((short *)(&TxBuff[6])) = CalcCRC(6, TxBuff);
;;;920    	return 8;
;;;921    }
000bfc  fa10f582          UXTAH    r5,r0,r2
000c00  ebb50f5c          CMP      r5,r12,LSR #1         ;857
000c04  d90a              BLS      |L1.3100|
000c06  4622              MOV      r2,r4                 ;857
000c08  e8bd4030          POP      {r4,r5,lr}            ;857
000c0c  2002              MOVS     r0,#2                 ;857
000c0e  f7ffbffe          B.W      ModbusErr
                  |L1.3090|
000c12  e8bd4030          POP      {r4,r5,lr}            ;856
000c16  2002              MOVS     r0,#2                 ;856
000c18  f7ffbffe          B.W      ModbusErr
                  |L1.3100|
000c1c  f2400c00          MOVW     r12,#:LOWER16: Metro
000c20  f2c00c00          MOVT     r12,#:UPPER16: Metro
000c24  f5a27500          SUB      r5,r2,#0x200          ;861
000c28  3d59              SUBS     r5,r5,#0x59           ;861
000c2a  bf08              IT       EQ                    ;861
000c2c  2803              CMPEQ    r0,#3                 ;861
000c2e  d02d              BEQ      |L1.3212|
000c30  f5a27500          SUB      r5,r2,#0x200          ;871
000c34  3d5d              SUBS     r5,r5,#0x5d           ;871
000c36  bf08              IT       EQ                    ;871
000c38  2803              CMPEQ    r0,#3                 ;871
000c3a  d031              BEQ      |L1.3232|
000c3c  f5a27c00          SUB      r12,r2,#0x200         ;881
000c40  f1bc0c52          SUBS     r12,r12,#0x52         ;881
000c44  bf08              IT       EQ                    ;881
000c46  2801              CMPEQ    r0,#1                 ;881
000c48  d038              BEQ      |L1.3260|
000c4a  eb030242          ADD      r2,r3,r2,LSL #1       ;893
000c4e  f04f0307          MOV      r3,#7                 ;894
000c52  f0120f02          TST      r2,#2                 ;897
000c56  d008              BEQ      |L1.3178|
000c58  f8b13007          LDRH     r3,[r1,#7]            ;898
000c5c  f1a00001          SUB      r0,r0,#1              ;899
000c60  ba5b              REV16    r3,r3                 ;898
000c62  f8223b02          STRH     r3,[r2],#2            ;898
000c66  f04f0309          MOV      r3,#9                 ;899
                  |L1.3178|
000c6a  2802              CMP      r0,#2                 ;903
000c6c  db0b              BLT      |L1.3206|
                  |L1.3182|
000c6e  eb010c03          ADD      r12,r1,r3             ;904
000c72  1e80              SUBS     r0,r0,#2              ;904
000c74  f8dcc000          LDR      r12,[r12,#0]          ;904
000c78  1d1b              ADDS     r3,r3,#4              ;904
000c7a  fa9cfc9c          REV16    r12,r12               ;904
000c7e  f842cb04          STR      r12,[r2],#4           ;904
000c82  2802              CMP      r0,#2                 ;903
000c84  daf3              BGE      |L1.3182|
                  |L1.3206|
000c86  2801              CMP      r0,#1                 ;910
000c88  d118              BNE      |L1.3260|
000c8a  e013              B        |L1.3252|
                  |L1.3212|
000c8c  7a88              LDRB     r0,[r1,#0xa]          ;862
000c8e  7b0a              LDRB     r2,[r1,#0xc]          ;862
000c90  0200              LSLS     r0,r0,#8              ;862
000c92  ea404002          ORR      r0,r0,r2,LSL #16      ;862
000c96  7a0a              LDRB     r2,[r1,#8]            ;862
000c98  4310              ORRS     r0,r0,r2              ;862
000c9a  f8cc0208          STR      r0,[r12,#0x208]       ;868  ; Metro
000c9e  e00d              B        |L1.3260|
                  |L1.3232|
000ca0  7a88              LDRB     r0,[r1,#0xa]          ;872
000ca2  7b0a              LDRB     r2,[r1,#0xc]          ;872
000ca4  0200              LSLS     r0,r0,#8              ;872
000ca6  ea404002          ORR      r0,r0,r2,LSL #16      ;872
000caa  7a0a              LDRB     r2,[r1,#8]            ;872
000cac  4310              ORRS     r0,r0,r2              ;872
000cae  f8cc0204          STR      r0,[r12,#0x204]       ;878  ; Metro
000cb2  e003              B        |L1.3260|
                  |L1.3252|
000cb4  18c8              ADDS     r0,r1,r3              ;911
000cb6  8800              LDRH     r0,[r0,#0]            ;911
000cb8  ba40              REV16    r0,r0                 ;911
000cba  8010              STRH     r0,[r2,#0]            ;911
                  |L1.3260|
000cbc  6808              LDR      r0,[r1,#0]            ;916
000cbe  6020              STR      r0,[r4,#0]            ;917
000cc0  6848              LDR      r0,[r1,#4]            ;917
000cc2  6060              STR      r0,[r4,#4]            ;919
000cc4  4621              MOV      r1,r4                 ;919
000cc6  2006              MOVS     r0,#6                 ;919
000cc8  f7fffffe          BL       CalcCRC
000ccc  80e0              STRH     r0,[r4,#6]            ;919
000cce  2008              MOVS     r0,#8                 ;920
000cd0  bd30              POP      {r4,r5,pc}
;;;922    
                          ENDP

                  SetUartParams PROC
;;;923    void SetUartParams(int Channel, int Params) {
000cd2  b4f0              PUSH     {r4-r7}
;;;924    	switch (Channel) {
;;;925    #if (USART1_PRESENT == YES)
;;;926    		case 1:	{ USART1->BRR	 =	APB2CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
000cd4  f2400c00          MOVW     r12,#:LOWER16: SystemCoreClock
000cd8  f2c00c00          MOVT     r12,#:UPPER16: SystemCoreClock
000cdc  f2400500          MOVW     r5,#:LOWER16: ||.data||+544
000ce0  f2c00500          MOVT     r5,#:UPPER16: ||.data||+544
;;;927    							USART1->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
000ce4  07ca              LSLS     r2,r1,#31
;;;928    																																							/* Parity select													*/
;;;929    							USART1->CR1  = (USART1->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;930    						} break;		
;;;931    #endif
;;;932    #if (USART2_PRESENT == YES)
;;;933    		case 2:	{ USART2->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
000ce6  f8dc4000          LDR      r4,[r12,#0]
000cea  f3c12302          UBFX     r3,r1,#8,#3           ;926
000cee  0c92              LSRS     r2,r2,#18             ;927
000cf0  f0010106          AND      r1,r1,#6              ;929
000cf4  f5a57602          SUB      r6,r5,#0x208          ;929
000cf8  ea4f0c94          LSR      r12,r4,#2
000cfc  2806              CMP      r0,#6                 ;924
;;;934    							USART2->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;935    																																							/* Parity select													*/
;;;936    							USART2->CR1  = (USART2->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;937    						} break;
;;;938    #endif
;;;939    
;;;940    		
;;;941    		
;;;942    		
;;;943    #if (USART3_PRESENT == YES)
;;;944    		case 3:	{ USART3->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;945    							USART3->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;946    																																							/* Parity select													*/
;;;947    							USART3->CR1  = (USART3->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;948    						} break;
;;;949    #endif
;;;950    
;;;951    #if (UART4_PRESENT  == YES)
;;;952      	case 4:	{ UART4->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;953    							UART4->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;954    																																							/* Parity select													*/
;;;955    							UART4->CR1  = (UART4->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;956    						} break;
;;;957    #endif
;;;958    
;;;959    #if (UART5_PRESENT  == YES)
;;;960    		case 5:	{ UART5->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;961    							UART5->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;962    																																							/* Parity select													*/
;;;963    							UART5->CR1  = (UART5->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;964    						} break;
;;;965    #endif
;;;966    
;;;967    #if (USART6_PRESENT == YES)
;;;968    		case 6:	{ USART6->BRR	 =	APB2CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;969    							USART6->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;970    																																							/* Parity select													*/
;;;971    							USART6->CR1  = (USART6->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;972    						} break;		
;;;973    #endif
;;;974    	}
;;;975    } //void SetUartParams(int Channel, int Params)
000cfe  bf24              ITT      CS
000d00  bcf0              POPCS    {r4-r7}
000d02  4770              BXCS     lr
000d04  e8dff000          TBB      [pc,r0]
000d08  1403162d          DCB      0x14,0x03,0x16,0x2d
000d0c  445b              DCB      0x44,0x5b
000d0e  0860              LSRS     r0,r4,#1              ;926
000d10  f8553023          LDR      r3,[r5,r3,LSL #2]     ;926
000d14  fbb0f3f3          UDIV     r3,r0,r3              ;926
000d18  f44f5080          MOV      r0,#0x1000            ;926
000d1c  f2c40001          MOVT     r0,#0x4001            ;926
000d20  8103              STRH     r3,[r0,#8]            ;926
000d22  8202              STRH     r2,[r0,#0x10]         ;927
000d24  8982              LDRH     r2,[r0,#0xc]          ;929
000d26  5a71              LDRH     r1,[r6,r1]            ;929
000d28  f42252b0          BIC      r2,r2,#0x1600         ;929
000d2c  4311              ORRS     r1,r1,r2              ;929
000d2e  8181              STRH     r1,[r0,#0xc]          ;929
000d30  bcf0              POP      {r4-r7}
000d32  4770              BX       lr
000d34  f8550023          LDR      r0,[r5,r3,LSL #2]     ;933
000d38  f2444308          MOV      r3,#0x4408            ;933
000d3c  fbbcf0f0          UDIV     r0,r12,r0             ;933
000d40  f2c40300          MOVT     r3,#0x4000            ;933
000d44  8018              STRH     r0,[r3,#0]            ;933
000d46  f2444010          MOV      r0,#0x4410            ;934
000d4a  f2c40000          MOVT     r0,#0x4000            ;934
000d4e  8002              STRH     r2,[r0,#0]            ;934
000d50  1f00              SUBS     r0,r0,#4              ;936
000d52  8802              LDRH     r2,[r0,#0]            ;936
000d54  5a71              LDRH     r1,[r6,r1]            ;936
000d56  f42252b0          BIC      r2,r2,#0x1600         ;936
000d5a  4311              ORRS     r1,r1,r2              ;936
000d5c  8001              STRH     r1,[r0,#0]            ;936
000d5e  bcf0              POP      {r4-r7}
000d60  4770              BX       lr
000d62  f8550023          LDR      r0,[r5,r3,LSL #2]     ;944
000d66  f6440308          MOV      r3,#0x4808            ;944
000d6a  fbbcf0f0          UDIV     r0,r12,r0             ;944
000d6e  f2c40300          MOVT     r3,#0x4000            ;944
000d72  8018              STRH     r0,[r3,#0]            ;944
000d74  f6440010          MOV      r0,#0x4810            ;945
000d78  f2c40000          MOVT     r0,#0x4000            ;945
000d7c  8002              STRH     r2,[r0,#0]            ;945
000d7e  1f00              SUBS     r0,r0,#4              ;947
000d80  8802              LDRH     r2,[r0,#0]            ;947
000d82  5a71              LDRH     r1,[r6,r1]            ;947
000d84  f42252b0          BIC      r2,r2,#0x1600         ;947
000d88  4311              ORRS     r1,r1,r2              ;947
000d8a  8001              STRH     r1,[r0,#0]            ;947
000d8c  bcf0              POP      {r4-r7}
000d8e  4770              BX       lr
000d90  f8550023          LDR      r0,[r5,r3,LSL #2]     ;952
000d94  f6444308          MOV      r3,#0x4c08            ;952
000d98  fbbcf0f0          UDIV     r0,r12,r0             ;952
000d9c  f2c40300          MOVT     r3,#0x4000            ;952
000da0  8018              STRH     r0,[r3,#0]            ;952
000da2  f6444010          MOV      r0,#0x4c10            ;953
000da6  f2c40000          MOVT     r0,#0x4000            ;953
000daa  8002              STRH     r2,[r0,#0]            ;953
000dac  1f00              SUBS     r0,r0,#4              ;955
000dae  8802              LDRH     r2,[r0,#0]            ;955
000db0  5a71              LDRH     r1,[r6,r1]            ;955
000db2  f42252b0          BIC      r2,r2,#0x1600         ;955
000db6  4311              ORRS     r1,r1,r2              ;955
000db8  8001              STRH     r1,[r0,#0]            ;955
000dba  bcf0              POP      {r4-r7}
000dbc  4770              BX       lr
000dbe  f8550023          LDR      r0,[r5,r3,LSL #2]     ;960
000dc2  fbbcf3f0          UDIV     r3,r12,r0             ;960
000dc6  f44f40a0          MOV      r0,#0x5000            ;960
000dca  f2c40000          MOVT     r0,#0x4000            ;960
000dce  8103              STRH     r3,[r0,#8]            ;960
000dd0  8202              STRH     r2,[r0,#0x10]         ;961
000dd2  8982              LDRH     r2,[r0,#0xc]          ;963
000dd4  5a71              LDRH     r1,[r6,r1]            ;963
000dd6  f42252b0          BIC      r2,r2,#0x1600         ;963
000dda  4311              ORRS     r1,r1,r2              ;963
000ddc  8181              STRH     r1,[r0,#0xc]          ;963
000dde  bcf0              POP      {r4-r7}
000de0  4770              BX       lr
;;;976    
                          ENDP

                  SetUartSpeed PROC
;;;977    void SetUartSpeed(int Channel, int Params)  {
000de2  b410              PUSH     {r4}
;;;978    	switch (Channel) {
;;;979    #if (USART1_PRESENT == YES)
;;;980    		case 1:	{ USART1->BRR	 =	APB2CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
000de4  f2400200          MOVW     r2,#:LOWER16: SystemCoreClock
000de8  f2c00200          MOVT     r2,#:UPPER16: SystemCoreClock
000dec  f2400c00          MOVW     r12,#:LOWER16: ||.data||+544
000df0  f2c00c00          MOVT     r12,#:UPPER16: ||.data||+544
;;;981    						} break;		
;;;982    #endif
;;;983    #if (USART2_PRESENT == YES)
;;;984    		case 2:	{ USART2->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
000df4  6813              LDR      r3,[r2,#0]
000df6  f3c12102          UBFX     r1,r1,#8,#3           ;980
000dfa  089a              LSRS     r2,r3,#2
000dfc  2806              CMP      r0,#6                 ;978
;;;985    						} break;
;;;986    #endif						
;;;987    #if (USART3_PRESENT == YES)
;;;988    		case 3:	{ USART3->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;989    						} break;
;;;990    #endif
;;;991    #if (UART4_PRESENT  == YES)
;;;992    		case 4:	{ UART4->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;993    						} break;
;;;994    #endif
;;;995    #if (UART5_PRESENT  == YES)
;;;996    		case 5:	{ UART5->BRR	 =	APB1CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;997    						} break;
;;;998    #endif
;;;999    #if (USART6_PRESENT == YES)
;;;1000   		case 6:	{ USART6->BRR	 =	APB2CLK / SpeedSelect[(Params & 0x700) >> 8];		/* Set Baudrate														*/
;;;1001   						} break;		
;;;1002   #endif
;;;1003   	}
;;;1004   } //void SetUartSpeed(int Channel, int Params)
000dfe  bf24              ITT      CS
000e00  bc10              POPCS    {r4}
000e02  4770              BXCS     lr
000e04  e8dff000          TBB      [pc,r0]
000e08  16030d18          DCB      0x16,0x03,0x0d,0x18
000e0c  212c              DCB      0x21,0x2c
000e0e  0858              LSRS     r0,r3,#1              ;980
000e10  f85c1021          LDR      r1,[r12,r1,LSL #2]    ;980
000e14  fbb0f0f1          UDIV     r0,r0,r1              ;980
000e18  f44f5180          MOV      r1,#0x1000            ;980
000e1c  f2c40101          MOVT     r1,#0x4001            ;980
000e20  e026              B        |L1.3696|
000e22  f85c0021          LDR      r0,[r12,r1,LSL #2]    ;984
000e26  f2444108          MOV      r1,#0x4408            ;984
000e2a  fbb2f0f0          UDIV     r0,r2,r0              ;984
000e2e  f2c40100          MOVT     r1,#0x4000            ;984
000e32  8008              STRH     r0,[r1,#0]            ;984
000e34  bc10              POP      {r4}
000e36  4770              BX       lr
000e38  f85c0021          LDR      r0,[r12,r1,LSL #2]    ;988
000e3c  f6440108          MOV      r1,#0x4808            ;988
000e40  fbb2f0f0          UDIV     r0,r2,r0              ;988
000e44  f2c40100          MOVT     r1,#0x4000            ;988
000e48  e007              B        |L1.3674|
000e4a  f85c0021          LDR      r0,[r12,r1,LSL #2]    ;992
000e4e  f6444108          MOV      r1,#0x4c08            ;992
000e52  fbb2f0f0          UDIV     r0,r2,r0              ;992
000e56  f2c40100          MOVT     r1,#0x4000            ;992
                  |L1.3674|
000e5a  8008              STRH     r0,[r1,#0]            ;992
000e5c  bc10              POP      {r4}
000e5e  4770              BX       lr
000e60  f85c0021          LDR      r0,[r12,r1,LSL #2]    ;996
000e64  f44f41a0          MOV      r1,#0x5000            ;996
000e68  fbb2f0f0          UDIV     r0,r2,r0              ;996
000e6c  f2c40100          MOVT     r1,#0x4000            ;996
                  |L1.3696|
000e70  8108              STRH     r0,[r1,#8]            ;996
000e72  bc10              POP      {r4}
000e74  4770              BX       lr
;;;1005   
                          ENDP

                  SetUartParity PROC
;;;1006   void SetUartParity(int Channel, int Params) {
000e76  f0010106          AND      r1,r1,#6
;;;1007   	switch (Channel) {
;;;1008   #if (USART1_PRESENT == YES)
;;;1009   		case 1:	{ USART1->CR1 = (USART1->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
000e7a  f2400200          MOVW     r2,#:LOWER16: ||.data||+24
000e7e  f2c00200          MOVT     r2,#:UPPER16: ||.data||+24
000e82  2806              CMP      r0,#6                 ;1007
;;;1010   						} break;	
;;;1011   #endif
;;;1012   #if (USART2_PRESENT == YES)
;;;1013   		case 2:	{ USART2->CR1 = (USART2->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;1014   						} break;
;;;1015   #endif
;;;1016   #if (USART3_PRESENT == YES)
;;;1017   		case 3:	{ USART3->CR1 = (USART3->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;1018   						} break;
;;;1019   #endif
;;;1020   #if (UART4_PRESENT  == YES)
;;;1021   		case 4:	{ UART4->CR1  = (UART4->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;1022   						} break;
;;;1023   #endif
;;;1024   #if (UART5_PRESENT  == YES)
;;;1025   		case 5:	{ UART5->CR1  = (UART5->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;1026   						} break;
;;;1027   #endif
;;;1028   #if (USART6_PRESENT == YES)
;;;1029   		case 6:	{ USART6->CR1 = (USART6->CR1 & ~(USART_CR1_M|USART_CR1_PCE|USART_CR1_PS)) | ParitySelect[(Params & 0x06) >> 1];
;;;1030   						} break;		
;;;1031   #endif
;;;1032   	}
;;;1033   } //void SetUartParity(int Channel, int Params)
000e84  bf28              IT       CS
000e86  4770              BXCS     lr
000e88  e8dff000          TBB      [pc,r0]
000e8c  0d030e19          DCB      0x0d,0x03,0x0e,0x19
000e90  242f              DCB      0x24,0x2f
000e92  f44f5080          MOV      r0,#0x1000            ;1009
000e96  f2c40001          MOVT     r0,#0x4001            ;1009
000e9a  8983              LDRH     r3,[r0,#0xc]          ;1009
000e9c  5a51              LDRH     r1,[r2,r1]            ;1009
000e9e  f42353b0          BIC      r3,r3,#0x1600         ;1009
000ea2  4319              ORRS     r1,r1,r3              ;1009
000ea4  8181              STRH     r1,[r0,#0xc]          ;1009
000ea6  4770              BX       lr
000ea8  f244400c          MOV      r0,#0x440c            ;1013
000eac  f2c40000          MOVT     r0,#0x4000            ;1013
000eb0  8803              LDRH     r3,[r0,#0]            ;1013
000eb2  5a51              LDRH     r1,[r2,r1]            ;1013
000eb4  f42353b0          BIC      r3,r3,#0x1600         ;1013
000eb8  4319              ORRS     r1,r1,r3              ;1013
000eba  8001              STRH     r1,[r0,#0]            ;1013
000ebc  4770              BX       lr
000ebe  f644000c          MOV      r0,#0x480c            ;1017
000ec2  f2c40000          MOVT     r0,#0x4000            ;1017
000ec6  8803              LDRH     r3,[r0,#0]            ;1017
000ec8  5a51              LDRH     r1,[r2,r1]            ;1017
000eca  f42353b0          BIC      r3,r3,#0x1600         ;1017
000ece  4319              ORRS     r1,r1,r3              ;1017
000ed0  8001              STRH     r1,[r0,#0]            ;1017
000ed2  4770              BX       lr
000ed4  f644400c          MOV      r0,#0x4c0c            ;1021
000ed8  f2c40000          MOVT     r0,#0x4000            ;1021
000edc  8803              LDRH     r3,[r0,#0]            ;1021
000ede  5a51              LDRH     r1,[r2,r1]            ;1021
000ee0  f42353b0          BIC      r3,r3,#0x1600         ;1021
000ee4  4319              ORRS     r1,r1,r3              ;1021
000ee6  8001              STRH     r1,[r0,#0]            ;1021
000ee8  4770              BX       lr
000eea  f44f40a0          MOV      r0,#0x5000            ;1025
000eee  f2c40000          MOVT     r0,#0x4000            ;1025
000ef2  8983              LDRH     r3,[r0,#0xc]          ;1025
000ef4  5a51              LDRH     r1,[r2,r1]            ;1025
000ef6  f42353b0          BIC      r3,r3,#0x1600         ;1025
000efa  4319              ORRS     r1,r1,r3              ;1025
000efc  8181              STRH     r1,[r0,#0xc]          ;1025
000efe  4770              BX       lr
;;;1034   
                          ENDP

                  SetUartStopBits PROC
;;;1035   void SetUartStopBits(int Channel, int Params) {
000f00  07c9              LSLS     r1,r1,#31
;;;1036   	switch (Channel) {
;;;1037   #if (USART1_PRESENT == YES)
;;;1038   		case 1:	{ USART1->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
000f02  0c89              LSRS     r1,r1,#18
000f04  2806              CMP      r0,#6                 ;1036
;;;1039   						} break;
;;;1040   #endif
;;;1041   #if (USART2_PRESENT == YES)
;;;1042   		case 2:	{ USART2->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;1043   						} break;
;;;1044   #endif
;;;1045   #if (USART3_PRESENT == YES)
;;;1046   		case 3:	{ USART3->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;1047   						} break;
;;;1048   #endif
;;;1049   #if (UART4_PRESENT  == YES)
;;;1050   		case 4:	{ UART4->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;1051   						} break;
;;;1052   #endif
;;;1053   #if (UART5_PRESENT  == YES)
;;;1054   		case 5:	{ UART5->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;1055   						} break;
;;;1056   #endif
;;;1057   #if (USART6_PRESENT == YES)
;;;1058   		case 6:	{ USART6->CR2	 = (Params & 0x01) << 13;														/* 2 Stop bits if Bit 0 in Params set			*/
;;;1059   						} break;		
;;;1060   #endif
;;;1061   	}
;;;1062   } //void SetUartStopbits(int Channel, int Params)
000f06  bf28              IT       CS
000f08  4770              BXCS     lr
000f0a  e8dff000          TBB      [pc,r0]
000f0e  0d03              DCB      0x0d,0x03
000f10  080e1319          DCB      0x08,0x0e,0x13,0x19
000f14  f44f5080          MOV      r0,#0x1000            ;1038
000f18  f2c40001          MOVT     r0,#0x4001            ;1038
000f1c  e014              B        |L1.3912|
000f1e  f2444010          MOV      r0,#0x4410            ;1042
000f22  f2c40000          MOVT     r0,#0x4000            ;1042
000f26  8001              STRH     r1,[r0,#0]            ;1042
000f28  4770              BX       lr
000f2a  f6440010          MOV      r0,#0x4810            ;1046
000f2e  f2c40000          MOVT     r0,#0x4000            ;1046
000f32  e003              B        |L1.3900|
000f34  f6444010          MOV      r0,#0x4c10            ;1050
000f38  f2c40000          MOVT     r0,#0x4000            ;1050
                  |L1.3900|
000f3c  8001              STRH     r1,[r0,#0]            ;1050
000f3e  4770              BX       lr
000f40  f44f40a0          MOV      r0,#0x5000            ;1054
000f44  f2c40000          MOVT     r0,#0x4000            ;1054
                  |L1.3912|
000f48  8201              STRH     r1,[r0,#0x10]         ;1054
000f4a  4770              BX       lr
;;;1063    	
                          ENDP

                  GetSavedUartParams PROC
;;;1064   
;;;1065    int GetSavedUartParams(int Port) 						{return SavePrms.UartParams[(Port-1) &0x07];	}
000f4c  1e40              SUBS     r0,r0,#1
000f4e  f0000007          AND      r0,r0,#7
000f52  f2400100          MOVW     r1,#:LOWER16: Metro
000f56  f2c00100          MOVT     r1,#:UPPER16: Metro
000f5a  eb010080          ADD      r0,r1,r0,LSL #2
000f5e  f8d00e80          LDR      r0,[r0,#0xe80]
000f62  4770              BX       lr
;;;1066   void PutSavedUartParams(int Port, int Params) {SavePrms.UartParams[(Port-1) &0x07] = Params;}
                          ENDP

                  PutSavedUartParams PROC
000f64  1e40              SUBS     r0,r0,#1
000f66  f0000007          AND      r0,r0,#7
000f6a  f2400200          MOVW     r2,#:LOWER16: Metro
000f6e  f2c00200          MOVT     r2,#:UPPER16: Metro
000f72  eb020080          ADD      r0,r2,r0,LSL #2
000f76  f8c01e80          STR      r1,[r0,#0xe80]
000f7a  4770              BX       lr
;;;1067   
                          ENDP


                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  USART1_TX_Buff
                          %        128
                  USART1_RX_Buff
                          %        128
                  USART2_TX_Buff
                          %        128
                  USART2_RX_Buff
                          %        128
                  USART3_TX_Buff
                          %        128
                  USART3_RX_Buff
                          %        128
                  USART4_TX_Buff
                          %        128
                  USART4_RX_Buff
                          %        128
                  USART5_TX_Buff
                          %        128
                  USART5_RX_Buff
                          %        128
                  USART6_TX_Buff
                          %        128
                  USART6_RX_Buff
                          %        128

                          AREA ||area_number.4||, DATA, NOINIT, ALIGN=2

                          EXPORTAS ||area_number.4||, ||.bss||
                  USART7_TX_Buff
                          %        128

                          AREA ||area_number.5||, DATA, NOINIT, ALIGN=2

                          EXPORTAS ||area_number.5||, ||.bss||
                  USART7_RX_Buff
                          %        128

                          AREA ||area_number.6||, DATA, NOINIT, ALIGN=2

                          EXPORTAS ||area_number.6||, ||.bss||
                  USART8_TX_Buff
                          %        128

                          AREA ||area_number.7||, DATA, NOINIT, ALIGN=2

                          EXPORTAS ||area_number.7||, ||.bss||
                  USART8_RX_Buff
                          %        128

                          AREA ||.data||, DATA, ALIGN=2

                  USART1_Proc
                          DCD      UsartDefaultHandler
                  USART2_Proc
                          DCD      UsartDefaultHandler
                  USART3_Proc
                          DCD      UsartDefaultHandler
                  USART4_Proc
                          DCD      UsartDefaultHandler
                  USART5_Proc
                          DCD      UsartDefaultHandler
                  USART6_Proc
                          DCD      UsartDefaultHandler
                  ParitySelect
000018  16001400          DCW      0x1600,0x1400
00001c  00000000          DCW      0x0000,0x0000
                  CRCTable
000020  0000c0c1          DCW      0x0000,0xc0c1
000024  c1810140          DCW      0xc181,0x0140
000028  c30103c0          DCW      0xc301,0x03c0
00002c  0280c241          DCW      0x0280,0xc241
000030  c60106c0          DCW      0xc601,0x06c0
000034  0780c741          DCW      0x0780,0xc741
000038  0500c5c1          DCW      0x0500,0xc5c1
00003c  c4810440          DCW      0xc481,0x0440
000040  cc010cc0          DCW      0xcc01,0x0cc0
000044  0d80cd41          DCW      0x0d80,0xcd41
000048  0f00cfc1          DCW      0x0f00,0xcfc1
00004c  ce810e40          DCW      0xce81,0x0e40
000050  0a00cac1          DCW      0x0a00,0xcac1
000054  cb810b40          DCW      0xcb81,0x0b40
000058  c90109c0          DCW      0xc901,0x09c0
00005c  0880c841          DCW      0x0880,0xc841
000060  d80118c0          DCW      0xd801,0x18c0
000064  1980d941          DCW      0x1980,0xd941
000068  1b00dbc1          DCW      0x1b00,0xdbc1
00006c  da811a40          DCW      0xda81,0x1a40
000070  1e00dec1          DCW      0x1e00,0xdec1
000074  df811f40          DCW      0xdf81,0x1f40
000078  dd011dc0          DCW      0xdd01,0x1dc0
00007c  1c80dc41          DCW      0x1c80,0xdc41
000080  1400d4c1          DCW      0x1400,0xd4c1
000084  d5811540          DCW      0xd581,0x1540
000088  d70117c0          DCW      0xd701,0x17c0
00008c  1680d641          DCW      0x1680,0xd641
000090  d20112c0          DCW      0xd201,0x12c0
000094  1380d341          DCW      0x1380,0xd341
000098  1100d1c1          DCW      0x1100,0xd1c1
00009c  d0811040          DCW      0xd081,0x1040
0000a0  f00130c0          DCW      0xf001,0x30c0
0000a4  3180f141          DCW      0x3180,0xf141
0000a8  3300f3c1          DCW      0x3300,0xf3c1
0000ac  f2813240          DCW      0xf281,0x3240
0000b0  3600f6c1          DCW      0x3600,0xf6c1
0000b4  f7813740          DCW      0xf781,0x3740
0000b8  f50135c0          DCW      0xf501,0x35c0
0000bc  3480f441          DCW      0x3480,0xf441
0000c0  3c00fcc1          DCW      0x3c00,0xfcc1
0000c4  fd813d40          DCW      0xfd81,0x3d40
0000c8  ff013fc0          DCW      0xff01,0x3fc0
0000cc  3e80fe41          DCW      0x3e80,0xfe41
0000d0  fa013ac0          DCW      0xfa01,0x3ac0
0000d4  3b80fb41          DCW      0x3b80,0xfb41
0000d8  3900f9c1          DCW      0x3900,0xf9c1
0000dc  f8813840          DCW      0xf881,0x3840
0000e0  2800e8c1          DCW      0x2800,0xe8c1
0000e4  e9812940          DCW      0xe981,0x2940
0000e8  eb012bc0          DCW      0xeb01,0x2bc0
0000ec  2a80ea41          DCW      0x2a80,0xea41
0000f0  ee012ec0          DCW      0xee01,0x2ec0
0000f4  2f80ef41          DCW      0x2f80,0xef41
0000f8  2d00edc1          DCW      0x2d00,0xedc1
0000fc  ec812c40          DCW      0xec81,0x2c40
000100  e40124c0          DCW      0xe401,0x24c0
000104  2580e541          DCW      0x2580,0xe541
000108  2700e7c1          DCW      0x2700,0xe7c1
00010c  e6812640          DCW      0xe681,0x2640
000110  2200e2c1          DCW      0x2200,0xe2c1
000114  e3812340          DCW      0xe381,0x2340
000118  e10121c0          DCW      0xe101,0x21c0
00011c  2080e041          DCW      0x2080,0xe041
000120  a00160c0          DCW      0xa001,0x60c0
000124  6180a141          DCW      0x6180,0xa141
000128  6300a3c1          DCW      0x6300,0xa3c1
00012c  a2816240          DCW      0xa281,0x6240
000130  6600a6c1          DCW      0x6600,0xa6c1
000134  a7816740          DCW      0xa781,0x6740
000138  a50165c0          DCW      0xa501,0x65c0
00013c  6480a441          DCW      0x6480,0xa441
000140  6c00acc1          DCW      0x6c00,0xacc1
000144  ad816d40          DCW      0xad81,0x6d40
000148  af016fc0          DCW      0xaf01,0x6fc0
00014c  6e80ae41          DCW      0x6e80,0xae41
000150  aa016ac0          DCW      0xaa01,0x6ac0
000154  6b80ab41          DCW      0x6b80,0xab41
000158  6900a9c1          DCW      0x6900,0xa9c1
00015c  a8816840          DCW      0xa881,0x6840
000160  7800b8c1          DCW      0x7800,0xb8c1
000164  b9817940          DCW      0xb981,0x7940
000168  bb017bc0          DCW      0xbb01,0x7bc0
00016c  7a80ba41          DCW      0x7a80,0xba41
000170  be017ec0          DCW      0xbe01,0x7ec0
000174  7f80bf41          DCW      0x7f80,0xbf41
000178  7d00bdc1          DCW      0x7d00,0xbdc1
00017c  bc817c40          DCW      0xbc81,0x7c40
000180  b40174c0          DCW      0xb401,0x74c0
000184  7580b541          DCW      0x7580,0xb541
000188  7700b7c1          DCW      0x7700,0xb7c1
00018c  b6817640          DCW      0xb681,0x7640
000190  7200b2c1          DCW      0x7200,0xb2c1
000194  b3817340          DCW      0xb381,0x7340
000198  b10171c0          DCW      0xb101,0x71c0
00019c  7080b041          DCW      0x7080,0xb041
0001a0  500090c1          DCW      0x5000,0x90c1
0001a4  91815140          DCW      0x9181,0x5140
0001a8  930153c0          DCW      0x9301,0x53c0
0001ac  52809241          DCW      0x5280,0x9241
0001b0  960156c0          DCW      0x9601,0x56c0
0001b4  57809741          DCW      0x5780,0x9741
0001b8  550095c1          DCW      0x5500,0x95c1
0001bc  94815440          DCW      0x9481,0x5440
0001c0  9c015cc0          DCW      0x9c01,0x5cc0
0001c4  5d809d41          DCW      0x5d80,0x9d41
0001c8  5f009fc1          DCW      0x5f00,0x9fc1
0001cc  9e815e40          DCW      0x9e81,0x5e40
0001d0  5a009ac1          DCW      0x5a00,0x9ac1
0001d4  9b815b40          DCW      0x9b81,0x5b40
0001d8  990159c0          DCW      0x9901,0x59c0
0001dc  58809841          DCW      0x5880,0x9841
0001e0  880148c0          DCW      0x8801,0x48c0
0001e4  49808941          DCW      0x4980,0x8941
0001e8  4b008bc1          DCW      0x4b00,0x8bc1
0001ec  8a814a40          DCW      0x8a81,0x4a40
0001f0  4e008ec1          DCW      0x4e00,0x8ec1
0001f4  8f814f40          DCW      0x8f81,0x4f40
0001f8  8d014dc0          DCW      0x8d01,0x4dc0
0001fc  4c808c41          DCW      0x4c80,0x8c41
000200  440084c1          DCW      0x4400,0x84c1
000204  85814540          DCW      0x8581,0x4540
000208  870147c0          DCW      0x8701,0x47c0
00020c  46808641          DCW      0x4680,0x8641
000210  820142c0          DCW      0x8201,0x42c0
000214  43808341          DCW      0x4380,0x8341
000218  410081c1          DCW      0x4100,0x81c1
00021c  80814040          DCW      0x8081,0x4040
                  SpeedSelect
                          DCD      0x00002580
                          DCD      0x00004b00
                          DCD      0x00009600
                          DCD      0x0000e100
                          DCD      0x0001c200
                          DCD      0x00038400
                          DCD      0x00070800
                          DCD      0x00501bd0

                          AREA ||area_number.10||, DATA, ALIGN=2

                          EXPORTAS ||area_number.10||, ||.data||
                  USART7_Proc
                          DCD      UsartDefaultHandler

                          AREA ||area_number.11||, DATA, ALIGN=2

                          EXPORTAS ||area_number.11||, ||.data||
                  USART8_Proc
                          DCD      UsartDefaultHandler

;*** Start embedded assembler ***

#line 1 "PERIPH\\usart.c"
	AREA ||.rev16_text||, CODE
	THUMB
	EXPORT |__asm___7_usart_c_CRCTable____REV16|
#line 129 ".\\STARTUP\\core_cmInstr.h"
|__asm___7_usart_c_CRCTable____REV16| PROC
#line 130

 rev16 r0, r0
 bx lr
	ENDP
	AREA ||.revsh_text||, CODE
	THUMB
	EXPORT |__asm___7_usart_c_CRCTable____REVSH|
#line 144
|__asm___7_usart_c_CRCTable____REVSH| PROC
#line 145

 revsh r0, r0
 bx lr
	ENDP

;*** End   embedded assembler ***
